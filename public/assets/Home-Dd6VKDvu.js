import{i as K,M as Ce,N as Ae,j as De,r as C,C as we,w as se,O as ie,l as i,n as t,q as n,h as r,P as ce,G as p,v as s,y as be,A as y,x as k,k as pe,D as u,H as f,Q as x,F as d,c as Y,z as le,m as Oe}from"./index-SDpjOfEK.js";import{G as re}from"./userData-C9zhAB8P.js";import{_ as Pe}from"./LoginView.vue_vue_type_script_setup_true_lang-DmYgnGWK.js";import{s as oe}from"./index-D_fG9q-s.js";import{F as E}from"./form-Cqw16b_M.js";import{S as F,a as Re}from"./submission-DAi9v6uc.js";import{u as Se}from"./useStoreAPI-zRRGrc1K.js";import{c as X}from"./canEditForm-Da19Rapt.js";import{s as Ve}from"./sortSubmissions-BLiX_qgz.js";import{P as Z,a as Fe,u as Ne}from"./useDisplayTransactions-CZK-2DHl.js";import{l as Me}from"./stripe.esm-v5H38J3X.js";import{_ as Te}from"./ModelDialog.vue_vue_type_script_setup_true_lang-CKqjlfMv.js";import{u as he}from"./useStripeConfig-QYWiwiGi.js";import{V as ne}from"./VContainer-wCvwEVPh.js";import{V as $e}from"./VAlert-Q2g8-bvw.js";import{V as Le}from"./VForm-DNwmPc0Q.js";import{V as q,a as z}from"./VRow-DPWtpV-z.js";import{V as v,o as Ye}from"./VGrid-BGPmBRnj.js";import{V as ke}from"./VSpacer-BubqRHeT.js";import{V as xe}from"./SaveButton.vue_vue_type_script_setup_true_lang-BphHTEIC.js";import{f as ze,h as ge}from"./date-DgbCHIwC.js";import{i as Be}from"./index.esm-CsVDj768.js";import{V as Ue,a as te,b as ye,c as ae,d as Ge,e as Ie}from"./VCard-DOrAlY6L.js";import{V as Ee}from"./forwardRefs-DfTulyk4.js";import{V as He}from"./VTooltip-Yq3_TLMu.js";import{V as qe,a as je,c as Ke,d as We}from"./VList-QopZ7B7L.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./emailFormVariant-DbFKH7n9.js";import"./LoginButton-By-bB-rl.js";import"./VToolbar-BcjPXdkE.js";import"./VDialog-M2iJhGkK.js";import"./VOverlay-CZc4vxJ-.js";import"./scopeId-G8KLxvpZ.js";import"./useConventionConfig-Df7ZblGN.js";import"./createSimpleFunctional-CSiOTkN6.js";import"./form-DiO8Onov.js";import"./VDivider-BQjLzC2r.js";const Je=["innerHTML"],Qe=K({__name:"StripePayment",props:Ce({paymentTransactions:{},registration:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],async setup(T){let _,N;const b=Ae(T,"modelValue"),g=ie(),l=re(),I=De(),U=C(),S=C((l==null?void 0:l.Additional.Email)||""),M=C(!1),B=C("");let $;const G=C(!1),{getStripeConfig:W}=he(),H=C();T.registration&&(H.value=([_,N]=we(()=>W(T.registration.ConventionUUID)),_=await _,N(),_)),se(b,O=>{O&&T.registration&&g.stripePublicKey(T.registration.ConventionUUID).then(async c=>{c&&(U.value=await Me(c),await Q(U.value))})});const J=O=>{B.value=O,M.value=!0};async function Q(O){var m;if(!O)return;const c=await g.stripePaymentIntent(((m=T.registration)==null?void 0:m.RegistrationUUID)||""),R={theme:"stripe"};I.current.value.dark&&(R.theme="night"),$=O.elements({clientSecret:c,appearance:R});const L=$.create("linkAuthentication",{defaultValues:{email:S.value}});L.mount("#link-authentication-element"),L.on("change",A=>{S.value=A.value.email});const o={layout:"tabs"};$.create("payment",o).mount("#payment-element")}async function ee(O,c){var o;if(!c)return;O.preventDefault(),G.value=!0;const R=new URL(location.href);R.pathname+=`payment/stripe/processing/${(o=T.registration)==null?void 0:o.ConventionUUID}`;const{error:L}=await c.confirmPayment({elements:$,confirmParams:{return_url:R.toString(),receipt_email:S.value}});L.type==="card_error"||L.type==="validation_error"?J(L.message):J("An unexpected error occurred."),G.value=!1}return(O,c)=>(t(),i(Te,{modelValue:b.value,"onUpdate:modelValue":c[4]||(c[4]=R=>b.value=R),title:"Make a Payment",color:"blue-darken-4",fullscreen:"",persistent:""},{default:n(()=>[r(ne,{class:"pa-0"},{default:n(()=>[r($e,{class:"mb-2 stripe-payment-information",closable:!0},ce({title:n(()=>[c[5]||(c[5]=s(" Payment Information "))]),_:2},[H.value?{name:"text",fn:n(()=>[p("div",{innerHTML:H.value.payment_information_html},null,8,Je)]),key:"0"}:void 0]),1024),r(Le,{id:"payment-form",onSubmit:c[1]||(c[1]=be(R=>ee(R,U.value),["prevent"]))},{default:n(()=>[r(q,null,{default:n(()=>[r(z,null,{default:n(()=>c[6]||(c[6]=[p("div",{id:"link-authentication-element"},null,-1)])),_:1})]),_:1}),r(q,null,{default:n(()=>[r(z,null,{default:n(()=>c[7]||(c[7]=[p("div",{id:"payment-element"},null,-1)])),_:1})]),_:1}),r(q,null,{default:n(()=>[O.registration?(t(),i(z,{key:0,class:"font-weight-bold text-right"},{default:n(()=>[s(" Payment Amount: £"+k(O.registration.Total-O.registration.Paid),1)]),_:1})):y("",!0)]),_:1}),r(q,null,{default:n(()=>[r(z,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:n(()=>[r(v,{color:"error",class:"w-100",onClick:c[0]||(c[0]=R=>b.value=!1)},{default:n(()=>c[8]||(c[8]=[s("Cancel")])),_:1})]),_:1}),r(ke),r(z,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:n(()=>[r(v,{type:"submit",color:"success",class:"w-100"},ce({default:n(()=>[c[9]||(c[9]=s(" Pay Now "))]),_:2},[G.value?{name:"prepend",fn:n(()=>[r(Ye,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1})]),_:1}),r(xe,{modelValue:M.value,"onUpdate:modelValue":c[3]||(c[3]=R=>M.value=R)},{actions:n(()=>[r(v,{variant:"text",onClick:c[2]||(c[2]=R=>M.value=!1)},{default:n(()=>c[10]||(c[10]=[s(" Close ")])),_:1})]),default:n(()=>[s(k(B.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),Xe={key:0},Ze={key:1,class:"v-row"},et={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},tt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},nt={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},ot={key:1,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},at={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},lt={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},st={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},it={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},rt={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},ut={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},dt=K({__name:"AttendeeTransactionList",props:{paymentTransactions:{},registration:{}},setup(T){const _=T,N=C(pe(_.paymentTransactions));se(_,()=>{N.value=pe(_.paymentTransactions)});const b=(g,l)=>g.Type===Z.PAYMENT_TRANSACTION_TYPE_CHARGE&&l.Type!==Z.PAYMENT_TRANSACTION_TYPE_CHARGE?-1:g.Type!==Z.PAYMENT_TRANSACTION_TYPE_CHARGE&&l.Type===Z.PAYMENT_TRANSACTION_TYPE_CHARGE||(g.UpdatedAt||0)>(l.UpdatedAt||0)?1:g.UpdatedAt===l.UpdatedAt?0:-1;return(g,l)=>g.paymentTransactions.length==0&&g.registration.Total==0?(t(),u("p",Xe," Your registration is currently being processed, payment information will appear here when ready. ")):(t(),u("dl",Ze,[(t(!0),u(f,null,x(N.value.sort(b),I=>{var U;return t(),u(f,{key:I.PaymentTransactionUUID},[I.Type===d(Z).PAYMENT_TRANSACTION_TYPE_CHARGE?(t(),u("dt",et,[p("div",tt,k(I.Description.split(":")[0]),1),p("div",nt,k(I.Description.split(":")[1]),1)])):(t(),u("dt",ot,[p("div",at,k((U=d(Fe).find(S=>S.value===I.Type))==null?void 0:U.title),1),p("div",lt," [ "+k(d(ze)(I.UpdatedAt||""))+" ] "+k(I.Description),1)])),p("dd",st," £"+k(I.Amount),1)],64)}),128)),l[0]||(l[0]=p("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),p("dd",it," £"+k(g.registration.Total),1),l[1]||(l[1]=p("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Current Payments ",-1)),p("dd",rt," £"+k(g.registration.Paid),1),l[2]||(l[2]=p("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance Due ",-1)),p("dd",ut," £"+k(g.registration.Total-g.registration.Paid),1)]))}}),mt=["innerHTML"],vt={key:0},ft={key:0,class:"font-weight-bold float-left pt-1 w-50"},ct={key:1,class:"pa-1"},pt={class:"font-weight-bold float-left pt-1 w-50 pt-3",style:{clear:"both"}},gt={class:"pt-2"},yt={key:0,class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},St={key:1},Tt={class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},kt={class:"text-red-darken-4"},Ut={key:1,class:"text-red-darken-4 mt-4"},It={class:"text-center"},Et=K({__name:"OpenConvention",props:{convention:{},forms:{default:()=>[]}},setup(T){const _=Se(),N=ie(),{getPaymentTransactions:b}=Ne(),g=C(_.GetConventionLogoURL(T.convention.ConventionUUID)),l=C(),I=C([]),U=C([]),S=C([]),M=C(!1),B=C(!1),$=C([]),G=Y(()=>{var o;return X(T.forms,((o=l.value)==null?void 0:o.Submissions)||[],E.FORM_TYPE_REGISTRATION)}),W=Y(()=>{var o;return X(T.forms,((o=l.value)==null?void 0:o.Submissions)||[],E.FORM_TYPE_DEALER)}),H=Y(()=>{var o;return X(T.forms,((o=l.value)==null?void 0:o.Submissions)||[],E.FORM_TYPE_BADGE)}),J=Y(()=>{var o;return X(T.forms,((o=l.value)==null?void 0:o.Submissions)||[],E.FORM_TYPE_ACCOMMODATION)}),Q=Y(()=>{var o;return X(T.forms,((o=l.value)==null?void 0:o.Submissions)||[],E.FORM_TYPE_ADDITIONAL)}),ee=Y(()=>l.value?T.forms.filter(o=>{var e;return o.State.Independent?(e=l.value)!=null&&e.Submissions?o.State.New?!l.value.Submissions.find(m=>{var A;return((A=m.Form)==null?void 0:A.FormUUID)===o.FormUUID}):!1:o.State.New:!1}):T.forms),O=Y(()=>{var o,e;return l.value&&((o=l.value)!=null&&o.Submissions)?!!((e=l.value)!=null&&e.Submissions.find(m=>{var A;return((A=m.Form)==null?void 0:A.Type)==E.FORM_TYPE_REGISTRATION&&(m.Status==F.SUBMISSION_STATUS_ACCEPTED||m.Status==F.SUBMISSION_STATUS_COMPLETED)})):!1}),c=Y(()=>{var o,e;return l.value&&((o=l.value)!=null&&o.Submissions)?!!((e=l.value)!=null&&e.Submissions.find(m=>{var A;return((A=m.Form)==null?void 0:A.Type)==E.FORM_TYPE_REGISTRATION&&m.Status==F.SUBMISSION_STATUS_COMPLETED})):!1}),R=async()=>{l.value&&"RegistrationUUID"in l.value&&N.getRegistrationAllocationPeriods(l.value.RegistrationUUID).then(o=>{o&&(U.value=[],I.value=o,I.value.sort((e,m)=>e.DateStart>m.DateStart?1:-1).forEach(e=>{var A;const m=U.value.find(P=>{var V;return P.name===((V=e.Accommodation)==null?void 0:V.Name)});if(m){const P=m.periods.find(w=>w.start===e.DateEnd),V=m.periods.find(w=>w.end===e.DateStart);P?P.start=e.DateStart:V?V.end=e.DateEnd:m.periods.push({start:e.DateStart,end:e.DateEnd})}else U.value.push({name:((A=e.Accommodation)==null?void 0:A.Name)||"",periods:[{start:e.DateStart,end:e.DateEnd}]})}))}).catch(()=>{})},L=()=>{N.getRegistrationByConvention(T.convention.ConventionUUID).then(o=>{var e;o&&(o.Submissions?(o.Submissions.forEach((m,A)=>{m.Form||(o.Submissions[A].Form=T.forms.find(P=>P.FormUUID===m.FormUUID))}),Ve(o.Submissions)):o.Submissions=[],l.value=o,R(),O.value&&b(((e=l.value)==null?void 0:e.RegistrationUUID)||"").then(m=>{S.value=m}))})};return se(()=>T.forms,()=>{L()}),L(),(o,e)=>{const m=le("router-link"),A=le("RouterLink");return t(),i(Ie,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:n(()=>[r(Ue,{class:"flex-1-1 align-content-start"},{default:n(()=>[g.value?(t(),i(Ee,{key:0,src:g.value,title:o.convention.Name,class:"logo text-center"},null,8,["src","title"])):y("",!0),o.convention.Name?(t(),i(te,{key:1,class:"text-center"},{default:n(()=>[s(k(o.convention.Name),1)]),_:1})):y("",!0),o.convention.Description?(t(),i(ye,{key:2,class:"text-wrap subtitle"},{default:n(()=>[p("div",{innerHTML:o.convention.Description},null,8,mt)]),_:1})):y("",!0)]),_:1}),r(ae,null,{default:n(()=>{var P,V,w;return[l.value?(t(),u("dl",vt,[l.value.Reference?(t(),u("dt",ft," Badge No: ")):y("",!0),l.value.Reference?(t(),u("dd",ct," #"+k(l.value.Reference),1)):y("",!0),ee.value.length>0?(t(),u(f,{key:2},[e[5]||(e[5]=p("dt",null,[p("h3",null,"Forms Available")],-1)),e[6]||(e[6]=p("dd",{class:"mb-2"}," The following forms are currently available for completion. ",-1))],64)):y("",!0),(t(!0),u(f,null,x(ee.value,(a,h)=>(t(),u(f,{key:a.FormUUID},[p("dt",pt,k(a.Heading),1),p("dd",gt,[(a==null?void 0:a.Type)===d(E).FORM_TYPE_DEALER?(t(),i(m,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:n(()=>[a!=null&&a.State.Edit&&W.value?(t(),i(v,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:n(()=>e[7]||(e[7]=[s(" Open form ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[8]||(e[8]=[s("View")])),_:1}))]),_:2},1032,["to"])):(a==null?void 0:a.Type)===d(E).FORM_TYPE_BADGE?(t(),i(m,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:n(()=>[a!=null&&a.State.Edit&&H.value?(t(),i(v,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:n(()=>e[9]||(e[9]=[s(" Open form ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[10]||(e[10]=[s("View")])),_:1}))]),_:2},1032,["to"])):(a==null?void 0:a.Type)===d(E).FORM_TYPE_ADDITIONAL?(t(),i(m,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:n(()=>[a!=null&&a.State.Edit&&Q.value?(t(),i(v,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:n(()=>e[11]||(e[11]=[s(" Open form ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[12]||(e[12]=[s("View")])),_:1}))]),_:2},1032,["to"])):y("",!0)])],64))),128)),((P=l.value)==null?void 0:P.Submissions.length)>0?(t(),u(f,{key:3},[e[13]||(e[13]=p("dt",{class:"mt-3"},[p("h3",null,"Received Forms")],-1)),e[14]||(e[14]=p("dd",{class:"mb-2"}," The following forms have been received from you. ",-1))],64)):y("",!0),(t(!0),u(f,null,x((V=l.value)==null?void 0:V.Submissions,(a,h)=>{var j,ue,de,me,ve,fe;return t(),u(f,{key:a.SubmissionUUID},[a.Form?(t(),u(f,{key:0},[a.Form?(t(),u("dt",yt,k(a.Form.Heading),1)):y("",!0),a.Form?(t(),u("dd",St,[r(He,{modelValue:$.value[h],"onUpdate:modelValue":D=>$.value[h]=D},{activator:n(({props:D})=>[r(v,Oe({ref_for:!0},D,{color:"blue-darken-2",icon:"mdi:mdi-information",variant:"text",size:"xs",onClick:Ot=>$.value[h]=!$.value[h]}),null,16,["onClick"])]),default:n(()=>[a.Status===d(F).SUBMISSION_STATUS_NULL?(t(),u(f,{key:0},[s(" There is an error with your submission, please contact the registration team for support. ")],64)):a.Status===d(F).SUBMISSION_STATUS_INCOMPLETE?(t(),u(f,{key:1},[s(" Something is missing on your submission which requires completing to be able to process your request. Please contact the registration team for further advice. ")],64)):a.Status===d(F).SUBMISSION_STATUS_OPEN?(t(),u(f,{key:2},[s(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):a.Status===d(F).SUBMISSION_STATUS_OPEN_2?(t(),u(f,{key:3},[s(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):a.Status===d(F).SUBMISSION_STATUS_LOCKED?(t(),u(f,{key:4},[s(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):a.Status===d(F).SUBMISSION_STATUS_LOCKED_2?(t(),u(f,{key:5},[s(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):a.Status===d(F).SUBMISSION_STATUS_ACCEPTED?(t(),u(f,{key:6},[s(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):a.Status===d(F).SUBMISSION_STATUS_COMPLETED?(t(),u(f,{key:7},[s(" Congratulations everything is complete. If you need to make changes please get in touch. ")],64)):a.Status===d(F).SUBMISSION_STATUS_REJECTED?(t(),u(f,{key:8},[s(" Your request has been unsuccessful. Contact the convention team for assistance. ")],64)):a.Status===d(F).SUBMISSION_STATUS_INVALID?(t(),u(f,{key:9},[s(" Your request has been identified as having errors or being incomplete. Please contact the registration team for additional support. ")],64)):a.Status===d(F).SUBMISSION_STATUS_CANCELLED?(t(),u(f,{key:10},[s(" Your submission has been cancelled. This may be at your request or another reason. The registration team will be able to provide further details. ")],64)):(t(),u(f,{key:11},[s(" Please contact the registration team for support. ")],64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(" "+k(d(Re)(a.Status,(j=a.Form)==null?void 0:j.Type))+" ",1),((ue=a.Form)==null?void 0:ue.Type)===d(E).FORM_TYPE_REGISTRATION?(t(),i(m,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/registration`},{default:n(()=>{var D;return[(D=a.Form)!=null&&D.State.Edit&&G.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[15]||(e[15]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[16]||(e[16]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((de=a.Form)==null?void 0:de.Type)===d(E).FORM_TYPE_ACCOMMODATION?(t(),i(m,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/accommodation`},{default:n(()=>{var D;return[(D=a.Form)!=null&&D.State.Edit&&J.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[17]||(e[17]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[18]||(e[18]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((me=a.Form)==null?void 0:me.Type)===d(E).FORM_TYPE_DEALER?(t(),i(m,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:n(()=>{var D;return[(D=a.Form)!=null&&D.State.Edit&&W.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[19]||(e[19]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[20]||(e[20]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((ve=a.Form)==null?void 0:ve.Type)===d(E).FORM_TYPE_BADGE?(t(),i(m,{key:3,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:n(()=>{var D;return[(D=a.Form)!=null&&D.State.Edit&&H.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[21]||(e[21]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[22]||(e[22]=[s("View")])),_:1}))]}),_:2},1032,["to"])):((fe=a.Form)==null?void 0:fe.Type)===d(E).FORM_TYPE_ADDITIONAL?(t(),i(m,{key:4,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:n(()=>{var D;return[(D=a.Form)!=null&&D.State.Edit&&Q.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[23]||(e[23]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[24]||(e[24]=[s("View")])),_:1}))]}),_:2},1032,["to"])):y("",!0)])):y("",!0)],64)):y("",!0)],64)}),128)),((w=l.value)==null?void 0:w.Submissions.length)>=1?(t(!0),u(f,{key:4},x(o.forms,a=>{var h;return t(),u(f,{key:a.FormUUID},[!((h=l.value)!=null&&h.Submissions.find(j=>j.FormUUID===a.FormUUID))&&!a.State.Independent?(t(),u(f,{key:0},[p("dt",Tt,k(a.Heading),1),p("dd",kt,[e[35]||(e[35]=s(" Requires Completion ")),a.Type===d(E).FORM_TYPE_REGISTRATION?(t(),i(m,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/registration`},{default:n(()=>[a.State.Edit&&G.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[25]||(e[25]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[26]||(e[26]=[s("View")])),_:1}))]),_:2},1032,["to"])):a.Type===d(E).FORM_TYPE_ACCOMMODATION?(t(),i(m,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/accommodation`},{default:n(()=>[a.State.Edit&&J.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[27]||(e[27]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[28]||(e[28]=[s("View")])),_:1}))]),_:2},1032,["to"])):a.Type===d(E).FORM_TYPE_DEALER?(t(),i(m,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:n(()=>[a.State.Edit&&W.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[29]||(e[29]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[30]||(e[30]=[s("View")])),_:1}))]),_:2},1032,["to"])):a.Type===d(E).FORM_TYPE_BADGE?(t(),i(m,{key:3,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:n(()=>[a.State.Edit&&H.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[31]||(e[31]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[32]||(e[32]=[s("View")])),_:1}))]),_:2},1032,["to"])):a.Type===d(E).FORM_TYPE_ADDITIONAL?(t(),i(m,{key:4,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:n(()=>[a.State.Edit&&Q.value?(t(),i(v,{key:0,size:"small",variant:"text",color:"success"},{default:n(()=>e[33]||(e[33]=[s(" Edit ")])),_:1})):(t(),i(v,{key:1,size:"small",variant:"text",color:"warning"},{default:n(()=>e[34]||(e[34]=[s("View")])),_:1}))]),_:2},1032,["to"])):y("",!0)])],64)):y("",!0)],64)}),128)):y("",!0)])):y("",!0),l.value&&l.value.Submissions.length>=1&&o.forms.filter(a=>{var h;return!a.State.Independent&&!((h=l.value)!=null&&h.Submissions.find(j=>j.FormUUID==a.FormUUID))}).length>0?(t(),u("div",Ut,e[36]||(e[36]=[p("strong",null,"There are forms above that require completion, please edit and save them.",-1)]))):y("",!0)]}),_:1}),U.value.length>0?(t(),u(f,{key:0},[r(te,{class:"pb-0"},{default:n(()=>e[37]||(e[37]=[s("Allocated Accommodation")])),_:1}),r(ye,{class:"text-wrap"},{default:n(()=>e[38]||(e[38]=[s("The following accommodation has been allocated to your registration. In some cases this may not have been your first choice.")])),_:1}),r(ae,null,{default:n(()=>[r(qe,{density:"compact"},{default:n(()=>[(t(!0),u(f,null,x(U.value,P=>(t(),i(je,{key:P.name},{default:n(()=>[r(Ke,null,{default:n(()=>[s(k(P.name),1)]),_:2},1024),(t(!0),u(f,null,x(P.periods,V=>(t(),i(We,{key:V.start},{default:n(()=>[s(" ("+k(d(ge)(V.start))+" - "+k(d(ge)(V.end))+")",1),e[39]||(e[39]=p("br",null,null,-1))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})],64)):y("",!0),O.value&&l.value?(t(),u(f,{key:1},[r(te,{class:"pb-4"},{default:n(()=>e[40]||(e[40]=[s("Payment Information")])),_:1}),r(ae,null,{default:n(()=>[r(dt,{"payment-transactions":S.value,registration:l.value},null,8,["payment-transactions","registration"])]),_:1})],64)):y("",!0),r(Ge,null,{default:n(()=>{var P,V;return[o.convention.DetailLink?(t(),i(v,{key:0,color:"warning",href:o.convention.DetailLink,variant:"flat"},{default:n(()=>[s(k(d(oe).buttonDetails),1)]),_:1},8,["href"])):y("",!0),r(ke),G.value?(t(),u(f,{key:1},[(P=l.value)!=null&&P.Submissions.find(w=>{var a;return((a=w.Form)==null?void 0:a.Type)===d(E).FORM_TYPE_REGISTRATION})?(t(),i(A,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}`},{default:n(()=>[r(v,{color:"primary",variant:"flat"},{default:n(()=>[s(k(d(oe).buttonViewRegistration),1)]),_:1})]),_:1},8,["to"])):(t(),u(f,{key:0},[(V=o.forms.find(w=>w.Type===d(E).FORM_TYPE_REGISTRATION))!=null&&V.State.New?(t(),i(A,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}`},{default:n(()=>[r(v,{color:"success",variant:"flat"},{default:n(()=>[s(k(d(oe).buttonRegister),1)]),_:1})]),_:1},8,["to"])):y("",!0)],64))],64)):O.value&&l.value&&l.value.Total>l.value.Paid?(t(),u(f,{key:2},[r(v,{color:"success",variant:"elevated",onClick:e[0]||(e[0]=w=>M.value=!0)},{default:n(()=>e[41]||(e[41]=[s(" Make Payment ")])),_:1}),l.value?(t(),i(Qe,{key:0,"payment-transactions":S.value,registration:l.value,modelValue:M.value,"onUpdate:modelValue":e[1]||(e[1]=w=>M.value=w)},null,8,["payment-transactions","registration","modelValue"])):y("",!0)],64)):l.value&&c.value&&l.value.Total==l.value.Paid?(t(),u(f,{key:3},[r(v,{color:"success",variant:"elevated",onClick:e[2]||(e[2]=w=>B.value=!0)},{default:n(()=>e[42]||(e[42]=[s(" Show Ticket ")])),_:1}),r(Te,{modelValue:B.value,"onUpdate:modelValue":e[4]||(e[4]=w=>B.value=w),scrollable:!0,title:"Convention Ticket",width:"auto"},{actions:n(()=>[r(v,{onClick:e[3]||(e[3]=w=>B.value=!1),width:"100%"},{default:n(()=>e[43]||(e[43]=[s("Close")])),_:1})]),default:n(()=>[r(d(Be),{value:l.value.RegistrationUUID,width:"200"},null,8,["value"]),p("p",It,[p("strong",null,"#"+k(l.value.Reference),1)])]),_:1},8,["modelValue"])],64)):y("",!0)]}),_:1})]),_:1})}}}),_t=_e(Et,[["__scopeId","data-v-04ac0a44"]]),Ct=K({__name:"Conventions",setup(T){const _=ie(),N=Se(),b=C([]),g=C([]),l=C([]);return _.getOpenConventionsList().then(I=>{I&&(g.value=[...g.value,...I],_.getAvailableConventionForms(g.value.map(U=>U.ConventionUUID)).then(U=>{l.value=[...l.value,...U]}).catch(U=>{console.error(U)}),_.getAttendedConventions().then(U=>{b.value=U}))}).catch(()=>{}),(I,U)=>(t(),u(f,null,[r(ne,null,{default:n(()=>[r(q,{class:"justify-center"},{default:n(()=>[(t(!0),u(f,null,x(g.value,S=>(t(),i(z,{key:S.ConventionUUID,cols:"12",sm:"11",md:"11",lg:"8",xl:"6",class:"d-flex flex-column"},{default:n(()=>[r(_t,{convention:S,forms:l.value.filter(M=>M.ConventionUUID===S.ConventionUUID)},null,8,["convention","forms"])]),_:2},1024))),128))]),_:1})]),_:1}),b.value.length>0?(t(),i(ne,{key:0,fluid:"",class:"px-0"},{default:n(()=>[r(q,{class:"bg-blue-darken-4"},{default:n(()=>[r(z,null,{default:n(()=>U[0]||(U[0]=[p("h3",{class:"font-weight-regular px-4"}," Convention Sticker Collection ",-1)])),_:1})]),_:1}),r(q,{class:"justify-center"},{default:n(()=>[(t(!0),u(f,null,x(b.value,S=>(t(),i(z,{key:S.ConventionUUID,cols:"8",sm:"6",md:"4",lg:"3",xl:"2"},{default:n(()=>[r(Ie,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:n(()=>[r(Ue,{class:"flex-1-1 align-content-start"},{default:n(()=>[r(Ee,{src:d(N).GetConventionLogoURL(S.ConventionUUID),title:S.Name,class:"logo text-center"},null,8,["src","title"]),S.Name?(t(),i(te,{key:0,class:"text-center text-wrap"},{default:n(()=>[s(k(S.Name),1)]),_:2},1024)):y("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):y("",!0)],64))}}),At={};function Dt(T,_){return t(),u("div")}const wt=_e(At,[["render",Dt]]),bt=K({__name:"MainView",emits:["pageTitle"],setup(T,{emit:_}){_("pageTitle","Upcoming Conventions"),sessionStorage.getItem("reload")==="true"&&(sessionStorage.removeItem("reload"),setTimeout(()=>{location.reload()},500));const g=localStorage.getItem("gjt_token"),l=localStorage.getItem("ajt_token");g?(localStorage.removeItem("gjt_token"),location.href=g):l&&(localStorage.removeItem("ajt_token"),location.href=l);const I=C(re());return(U,S)=>{const M=le("router-link");return t(),u(f,null,[I.value&&(!I.value.Additional||!I.value.Additional.Email)?(t(),i(ne,{key:0,class:"bg-red-darken-4 text-center",fluid:!0},{default:n(()=>[S[1]||(S[1]=s(" Please enter a Contact Email on the ")),r(M,{to:"/profile",class:"text-white font-weight-bold"},{default:n(()=>S[0]||(S[0]=[s("manage account page")])),_:1}),S[2]||(S[2]=s(" to ensure we can contact you. "))]),_:1})):y("",!0),r(Ct),r(wt)],64)}}}),pn=K({__name:"Home",props:{loggedIn:{type:Boolean}},emits:["pageTitle"],setup(T,{emit:_}){const N=re(),b=_;return b("pageTitle","Login"),(g,l)=>(t(),u("div",null,[g.loggedIn&&d(N)?(t(),i(bt,{key:0,onPageTitle:l[0]||(l[0]=I=>b("pageTitle",I))})):(t(),i(Pe,{key:1}))]))}});export{pn as default};
