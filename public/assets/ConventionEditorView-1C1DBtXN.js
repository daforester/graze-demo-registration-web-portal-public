import{s as L}from"./index-CndaLrdX.js";import{i as P,L as q,M as w,r as b,k as H,l as C,n as f,q as l,h as e,v as _,A as M,F as y,N as B,c as ae,D as S,H as A,G as N,P as h,x as O,y as oe,m as Ce,w as Q,V as Se,W as be,X as ye,Y as Fe,O as Ue,U as ke,C as Ee,s as ue,Z as He,_ as ol,R as nl,S as Ae}from"./index-BlLj1EIR.js";import{m as $e,a as we,s as je,b as ul}from"./sorted-PYsDa1V2.js";import{_ as Z,I as il,a as ze,u as dl}from"./useLinkedFields-5yrwudOA.js";import{_ as ee}from"./SaveButton.vue_vue_type_script_setup_true_lang-Dd8SfRrX.js";import{e as se,c as De}from"./VCard-99ogaFVL.js";import{V as re,a as me}from"./VToolbar-Bx-P8UQH.js";import{V as x,d as X,o as qe}from"./VGrid-7rkb_PTp.js";import{V as ne}from"./VSpacer-VCo_RwVw.js";import{V as Te}from"./VToolbarItems-CpWkQu7m.js";import{V as z}from"./VContainer-DO1alIIn.js";import{V as R}from"./VTextField-CtsXnrkb.js";import{_ as Le}from"./SelectGroups.vue_vue_type_script_setup_true_lang-C0hWafFv.js";import{V as Ne,a as ie,d as te,b as Re}from"./VList-CtYtMkc5.js";import{V as F,a as D}from"./VRow-D0N6zb5D.js";import{V as Ie}from"./VDialog-BAG5YxvL.js";import{v as $}from"./v4-CtRu48qb.js";import{V as pe,a as fe,b as Ve,c as ce}from"./VExpansionPanels-u9tw036o.js";import{V as ve}from"./VTextarea-EpzhBNCN.js";import{T as K,a as sl}from"./ticket-DqurB3v3.js";import{V as rl}from"./VAutocomplete-CQ1PwUGj.js";import{V as W}from"./VSelect-DLyEnfjJ.js";import{V as j}from"./VCheckbox-DxllQEAE.js";import{V as Je,a as he}from"./VChip-CojXRfdd.js";import{V as ml}from"./VTable-X6oq_GOM.js";import{V as le}from"./VSheet-Dnm1ZIfa.js";import{_ as Ke}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-DDJ9lXZc.js";import{u as de}from"./useModel-gMp4PF3e.js";import{_ as Ge}from"./ModelDialog.vue_vue_type_script_setup_true_lang-luAlaFYd.js";import{p as vl,F as We,a as Y,_ as Xe,b as pl}from"./FormRenderer.vue_vue_type_style_index_0_lang-2TpY-3hG.js";import{V as Ze}from"./VDivider-Cdrzvo_N.js";import{V as Qe}from"./VDataTable-tS5QN_h_.js";import{a as fl,F as Vl}from"./form-Cqw16b_M.js";import{b as cl}from"./forwardRefs-Bv-WhiJZ.js";import{E as Ul}from"./EditConventionDialog-BLPTXGm7.js";import{u as Dl}from"./useConventionForms-C7j1Dk7k.js";import{V as Be}from"./VForm-CL8_ydZU.js";import{u as Tl}from"./useStripeConfig-445igOuN.js";import{V as Il}from"./VTooltip-D2lew6ZX.js";import{V as gl,a as yl}from"./VAlert-D7xRiYbT.js";import{V as xe,a as Me,b as Pe,c as Oe}from"./VTabs-DNAWrkTi.js";import{u as el}from"./useConventionConfig-C3OUbVhE.js";import"./VOverlay-BKei1bKT.js";import"./scopeId-n-34JHVv.js";import"./createSimpleFunctional-CDvXpBHg.js";import"./form-D_Jx2O_R.js";import"./filter-BCiHd97z.js";import"./submission-DAi9v6uc.js";import"./copyToClipboard-BtcEYe2-.js";import"./useStoreAPI-CrefURsN.js";import"./VFileInput-Dmb3dDko.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./userData-B-gHL323.js";var _e=(g=>(g.PER_ROOM="PER_ROOM",g.PER_PERSON="PER_PERSON",g))(_e||{}),ll=(g=>(g.INCREMENTAL="INCREMENTAL_NUMBERS",g.NONE="",g.RANDOM_LETTERS="RANDOM_LETTERS",g.RANDOM_NUMBERS="RANDOM_NUMBERS",g))(ll||{}),tl=(g=>(g.NONE="",g))(tl||{});const Cl=[{title:"Do Not Assign",value:""},{title:"Incremental Numbers",value:"INCREMENTAL_NUMBERS"},{title:"Random Numbers",value:"RANDOM_NUMBERS"},{title:"Random Letters",value:"RANDOM_LETTERS"}],bl=[{title:"Do Not Generate",value:""}],kl=P({__name:"EditConventionExtraOptions",props:q({convention:{}},{modelValue:{},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(g,{emit:m}){const o=m,r=w(g,"modelValue"),p=b(H(r.value)),d=()=>{r.value=p.value,o("close")};return(n,u)=>(f(),C(se,null,{default:l(()=>[e(re,{dark:"",color:"primary"},{default:l(()=>[e(x,{icon:"",dark:"",onClick:u[0]||(u[0]=t=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>u[6]||(u[6]=[_("mdi:mdi-close")])),_:1})]),_:1}),e(me,null,{default:l(()=>u[7]||(u[7]=[_("Edit Option Choice")])),_:1}),e(ne),e(Te,null,{default:l(()=>[e(x,{variant:"text",onClick:d},{default:l(()=>u[8]||(u[8]=[_(" Apply ")])),_:1})]),_:1})]),_:1}),e(De,{class:"pa-0"},{default:l(()=>[e(z,null,{default:l(()=>[e(R,{label:y(L).formLabelName,type:"text",variant:"outlined",modelValue:p.value.Name,"onUpdate:modelValue":u[1]||(u[1]=t=>p.value.Name=t)},null,8,["label","modelValue"]),e(R,{label:y(L).formLabelDescription,type:"text",variant:"outlined",modelValue:p.value.Description,"onUpdate:modelValue":u[2]||(u[2]=t=>p.value.Description=t)},null,8,["label","modelValue"]),e(R,{label:y(L).formLabelPrice,type:"text",variant:"outlined","prepend-icon":y(L).currencyIcon,modelValue:p.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>p.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),e(Z,{modelValue:p.value.Tags,"onUpdate:modelValue":u[4]||(u[4]=t=>p.value.Tags=t),convention:n.convention,hint:"Tags acquired by selecting this option & any choice within it."},null,8,["modelValue","convention"]),p.value.Choices?(f(),C(Z,{key:0,modelValue:p.value.Choices,"onUpdate:modelValue":u[5]||(u[5]=t=>p.value.Choices=t),convention:n.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):M("",!0)]),_:1})]),_:1})]),_:1}))}}),El=P({__name:"EditConventionExtra",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=b(H(m.value)),r=b(!1),p=b(0),d=B(),n=b([""]),u=b([]),t=b([]);g.convention&&(d.getConventionTags(g.convention.ConventionUUID).then(i=>{t.value=i.sort((c,I)=>c.Title.localeCompare(I.Title))}),d.getOrganisationTags(g.convention.OrganisationUUID).then(i=>{u.value=i.sort((c,I)=>c.Title.localeCompare(I.Title))}));const a=ae(()=>[...u.value,...t.value]),v=({callback:i})=>{d.saveExtra(o.value).then(c=>{c?(m.value=c,i&&i("Extra Saved")):i&&i("Failed to Save Extra")}).catch(()=>{i&&i("Failed to Save Extra")})},V=i=>{var c;i.Options||(i.Options=[]),i.Options.push({ID:0,OptionUUID:$(),ExtraID:i.ID,ExtraUUID:i.ExtraUUID,Order:((c=i.Options)==null?void 0:c.length)+1,Name:"",Description:"",Price:0,Choices:[],Tags:[]})},U=(i,c)=>{i.Options&&i.Options.splice(c,1)},s=i=>{if(i.Choices&&i.Choices.length>0)return i.Choices.map(c=>{const I=a.value.find(k=>k.TagUUID===c.TagUUID);if(I)return I.Title}).join(", ")};return(i,c)=>(f(),S(A,null,[e(z,{class:"px-0"},{default:l(()=>[e(R,{label:y(L).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":c[0]||(c[0]=I=>o.value.Name=I)},null,8,["label","modelValue"]),e(R,{label:y(L).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":c[1]||(c[1]=I=>o.value.Description=I)},null,8,["label","modelValue"]),e(Z,{modelValue:o.value.AppliesTags,"onUpdate:modelValue":c[2]||(c[2]=I=>o.value.AppliesTags=I),convention:i.convention,organisation:i.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(Z,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":c[3]||(c[3]=I=>o.value.RequiredTags=I),convention:i.convention,organisation:i.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),e(Le,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":c[4]||(c[4]=I=>o.value.RequiredGroupMemberships=I),convention:i.convention,organisation:i.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),c[11]||(c[11]=N("h3",null,"Options",-1)),e(Ne,{opened:n.value,"onUpdate:opened":c[5]||(c[5]=I=>n.value=I)},{default:l(()=>[(f(!0),S(A,null,h(o.value.Options,(I,k)=>(f(),S(A,{key:I.ID},[I?(f(),C(ie,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${I.Name} ${I.Price&&I.Price>0?`(${y(L).currencySymbol}${I.Price})`:""}`},{append:l(()=>[e(x,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:T=>U(o.value,k)},null,8,["onClick"]),e(x,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:T=>{r.value=!0,p.value=k}},null,8,["onClick"])]),default:l(()=>[I.Choices&&I.Choices.length>0?(f(),C(te,{key:0},{default:l(()=>[_(" Options: "+O(s(I)),1)]),_:2},1024)):M("",!0)]),_:2},1032,["title"])):M("",!0)],64))),128))]),_:1},8,["opened"]),e(x,{color:"primary",onClick:c[6]||(c[6]=I=>V(o.value))},{default:l(()=>c[10]||(c[10]=[_("Add Option")])),_:1}),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(ee,{onClick:v})]),_:1})]),_:1})]),_:1}),e(Ie,{modelValue:r.value,"onUpdate:modelValue":c[9]||(c[9]=I=>r.value=I),scrollable:""},{default:l(()=>[e(kl,{modelValue:o.value.Options[p.value],"onUpdate:modelValue":c[7]||(c[7]=I=>o.value.Options[p.value]=I),convention:i.convention,onClose:c[8]||(c[8]=I=>r.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),_l=P({__name:"EditConventionExtras",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(g,{emit:m}){const o=m,r=w(g,"modelValue"),p=B(),d=()=>{const t={ID:0,ExtraUUID:$(),ConventionID:g.convention.ID,ConventionUUID:g.convention.ConventionUUID,Order:r.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[],Tags:[]};p.saveExtra(t).then(a=>{a&&r.value.push(a)})},n=t=>{p.deleteExtra(r.value[t].ExtraUUID).then(a=>{a&&r.value.splice(t,1)})},u=(...t)=>{t.forEach(a=>{a>=0&&a<r.value.length&&p.saveExtra(r.value[a])})};return(t,a)=>(f(),C(se,null,{default:l(()=>[e(re,{dark:"",color:"primary"},{default:l(()=>[e(me,null,{default:l(()=>a[1]||(a[1]=[_("Edit Extras")])),_:1}),e(ne),e(Te,null,{default:l(()=>[e(x,{variant:"text",onClick:d},{default:l(()=>a[2]||(a[2]=[_(" Add ")])),_:1}),e(x,{icon:"",dark:"",onClick:a[0]||(a[0]=v=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[_("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(De,{class:"pa-0"},{default:l(()=>[e(pe,null,{default:l(()=>[(f(!0),S(A,null,h(r.value,(v,V)=>(f(),C(fe,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ve,null,{actions:l(({expanded:U})=>[e(x,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:s=>n(V)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:U?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(x,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:oe(U=>{y($e)(v,r.value),u(V,V-1)},["stop"])},null,8,["onClick"]),e(x,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:oe(U=>{y(we)(v,r.value),u(V,V+1)},["stop"])},null,8,["onClick"]),_(" "+O(v.Name)+" ",1)]),_:2},1024),e(ce,{class:"px-0"},{default:l(()=>[e(El,{convention:t.convention,modelValue:r.value[V],"onUpdate:modelValue":U=>r.value[V]=U},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Sl=P({__name:"Extras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=b([]),r=B(),p=b([""]),d=b(!1),n=t=>{if(t.Choices&&t.Choices.length>0)return t.Choices.map(a=>a.Title).join(", ")},u=()=>{d.value=!1};return r==null||r.getConventionExtras(m.value.ConventionUUID||"").then(t=>{t&&(o.value=t)}),(t,a)=>(f(),S(A,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>a[4]||(a[4]=[N("h3",null,"Additional Purchases",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(x,{color:"primary",onClick:a[0]||(a[0]=v=>d.value=!0)},{default:l(()=>a[5]||(a[5]=[_("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),a[6]||(a[6]=N("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1)),e(Ne,{opened:p.value,"onUpdate:opened":a[1]||(a[1]=v=>p.value=v)},{default:l(()=>[(f(!0),S(A,null,h(o.value,v=>(f(),C(Re,{key:v.ID,value:v.ID},{activator:l(({props:V})=>[e(ie,Ce({ref_for:!0},V,{"prepend-icon":"mdi:mdi-group",title:v.Name}),null,16,["title"])]),default:l(()=>[v.Options?(f(!0),S(A,{key:0},h(v.Options,V=>(f(),C(ie,{key:V.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${V.Name} ${V.Price&&V.Price>0?`(${y(L).currencySymbol}${V.Price})`:""}`},{default:l(()=>[V.Choices&&V.Choices.length>0?(f(),C(te,{key:0},{default:l(()=>[_(" Options: "+O(n(V)),1)]),_:2},1024)):M("",!0)]),_:2},1032,["title"]))),128)):M("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Ie,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=v=>d.value=v),scrollable:!0,persistent:!0,fullscreen:!0},{default:l(()=>[e(_l,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=v=>o.value=v),convention:m.value,onClose:u},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),Nl=P({__name:"EditConventionInterest",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=b(H(m.value)),r=B(),p=({callback:d})=>{r.saveInterest(o.value).then(n=>{n?(m.value=n,d&&d("Interest Saved")):d&&d("Failed to Save Interest")}).catch(()=>{d&&d("Failed to Save Interest")})};return(d,n)=>(f(),C(z,{class:"px-0"},{default:l(()=>[e(R,{label:y(L).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":n[0]||(n[0]=u=>o.value.Name=u)},null,8,["label","modelValue"]),e(ve,{label:y(L).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":n[1]||(n[1]=u=>o.value.Description=u)},null,8,["label","modelValue"]),M("",!0),e(Z,{modelValue:o.value.AppliesTags,"onUpdate:modelValue":n[3]||(n[3]=u=>o.value.AppliesTags=u),convention:d.convention,organisation:d.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(ee,{onClick:p})]),_:1})]),_:1})]),_:1}))}}),Al=P({__name:"EditConventionInterests",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(g,{emit:m}){const o=m,r=w(g,"modelValue"),p=B(),d=()=>{const t={ID:0,InterestUUID:$(),ConventionID:g.convention.ID,ConventionUUID:g.convention.ConventionUUID,Order:r.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};p.saveInterest(t).then(a=>{a&&r.value.push(a)})},n=t=>{p.deleteInterest(r.value[t].InterestUUID).then(a=>{a&&r.value.splice(t,1)})},u=(...t)=>{t.forEach(a=>{a>=0&&a<r.value.length&&p.saveInterest(r.value[a])})};return(t,a)=>(f(),C(se,null,{default:l(()=>[e(re,{dark:"",color:"primary"},{default:l(()=>[e(me,null,{default:l(()=>a[1]||(a[1]=[_("Edit Interests")])),_:1}),e(ne),e(Te,null,{default:l(()=>[e(x,{variant:"text",onClick:d},{default:l(()=>a[2]||(a[2]=[_(" Add ")])),_:1}),e(x,{icon:"",dark:"",onClick:a[0]||(a[0]=v=>o("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[_("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(De,{class:"pa-0"},{default:l(()=>[e(pe,null,{default:l(()=>[(f(!0),S(A,null,h(r.value,(v,V)=>(f(),C(fe,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ve,null,{actions:l(({expanded:U})=>[e(ee,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:s=>n(V)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:U?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(x,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:oe(U=>{y($e)(v,r.value),u(V,V-1)},["stop"])},null,8,["onClick"]),e(x,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:oe(U=>{y(we)(v,r.value),u(V,V+1)},["stop"])},null,8,["onClick"]),_(" "+O(v.Name)+" ",1)]),_:2},1024),e(ce,{class:"px-0"},{default:l(()=>[e(Nl,{convention:t.convention,modelValue:r.value[V],"onUpdate:modelValue":U=>r.value[V]=U},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Fl=P({__name:"Interests",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(g){const m=w(g,"modelValue"),o=B(),r=b([]);o.getConventionInterests(m.value.ConventionUUID).then(n=>{je(n),r.value=n});const p=b([""]),d=b(!1);return(n,u)=>(f(),S(A,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>u[5]||(u[5]=[N("h3",null,"Interests",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(x,{color:"primary",onClick:u[0]||(u[0]=t=>d.value=!0)},{default:l(()=>u[6]||(u[6]=[_("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),u[7]||(u[7]=N("p",null,"Attendees can tag themselves for particular things.",-1)),e(Ne,{opened:p.value,"onUpdate:opened":u[1]||(u[1]=t=>p.value=t)},{default:l(()=>[(f(!0),S(A,null,h(r.value,t=>(f(),C(ie,{key:t.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${t.Name} ${t.Price&&t.Price>0?`(${y(L).currencySymbol}${t.Price})`:""}`},{default:l(()=>[t.Description?(f(),C(te,{key:0},{default:l(()=>[_(O(t.Description),1)]),_:2},1024)):M("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(Ie,{modelValue:d.value,"onUpdate:modelValue":u[4]||(u[4]=t=>d.value=t),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(Al,{onClose:u[2]||(u[2]=t=>d.value=!1),convention:m.value,modelValue:r.value,"onUpdate:modelValue":u[3]||(u[3]=t=>r.value=t)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),ge=P({__name:"SelectTickets",props:q({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=p=>p.Type===K.TICKET_TYPE_GROUP?"mdi:mdi-group":p.Type===K.TICKET_TYPE_TICKET?p.RequiresAccommodation?"mdi:mdi-home":p.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":p.Type===K.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":p.Type===K.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",r=ae(()=>g.tickets.map(p=>({title:p.Name,value:m.value.find(d=>d&&d.TicketUUID===p.TicketUUID)||p,props:{appendIcon:o(p)}})));return(p,d)=>(f(),S("div",null,[e(rl,{label:p.label,variant:p.variant||"filled",items:r.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:m.value,"onUpdate:modelValue":d[0]||(d[0]=n=>m.value=n),hint:p.hint,chips:p.chips,clearable:p.clearable,multiple:"","persistent-hint":p.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Rl=P({__name:"EditConventionTicket",props:q({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=b(H(m.value)),r=B(),p=ae(()=>g.tickets.filter(a=>a.Type===K.TICKET_TYPE_TICKET)),d=ae(()=>g.tickets.filter(a=>a.Type===K.TICKET_TYPE_ADD_ON)),n=ae(()=>g.tickets.filter(a=>a.Type===K.TICKET_TYPE_TICKET_COMPONENT)),u=a=>g.accommodation.filter(v=>v.Costs.find(V=>V.DateStart===a.DateStart&&V.DateEnd===a.DateEnd)),t=({callback:a})=>{r.saveTicket(o.value).then(v=>{v?(o.value.ID=v.ID,o.value.TicketUUID=v.TicketUUID,m.value=o.value,a&&a("Ticket Saved")):a&&a("Failed to Save Ticket")}).catch(()=>{a&&a("Failed to Save Ticket")})};return(a,v)=>(f(),C(z,{class:"px-0",fluid:""},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(W,{label:"Ticket Type",variant:"outlined",modelValue:o.value.Type,"onUpdate:modelValue":v[0]||(v[0]=V=>o.value.Type=V),items:y(sl),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:y(L).formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":v[1]||(v[1]=V=>o.value.Name=V),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:y(L).formLabelDescription,type:"text",variant:"outlined",modelValue:o.value.Description,"onUpdate:modelValue":v[2]||(v[2]=V=>o.value.Description=V),"hide-details":""},null,8,["label","modelValue"])]),_:1}),o.value.Type!==y(K).TICKET_TYPE_GROUP?(f(),S(A,{key:0},[e(D,{cols:"12"},{default:l(()=>[e(j,{label:y(L).formLabelRequiresAccommodation,modelValue:o.value.RequiresAccommodation,"onUpdate:modelValue":v[3]||(v[3]=V=>o.value.RequiresAccommodation=V),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:y(L).formLabelDateStart,type:"date",variant:"outlined",modelValue:o.value.DateStart,"onUpdate:modelValue":v[4]||(v[4]=V=>o.value.DateStart=V),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:y(L).formLabelDateEnd,type:"date",variant:"outlined",modelValue:o.value.DateEnd,"onUpdate:modelValue":v[5]||(v[5]=V=>o.value.DateEnd=V),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:y(L).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":y(L).currencyIcon,modelValue:o.value.Price,"onUpdate:modelValue":v[6]||(v[6]=V=>o.value.Price=V),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(f(),C(D,{key:1,cols:"12"},{default:l(()=>[e(ge,{label:"Tickets",variant:"outlined",tickets:p.value,modelValue:o.value.Tickets,"onUpdate:modelValue":v[7]||(v[7]=V=>o.value.Tickets=V),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(D,{cols:"12"},{default:l(()=>[e(Z,{label:"Applied Tags",variant:"outlined",modelValue:o.value.AppliesTags,"onUpdate:modelValue":v[8]||(v[8]=V=>o.value.AppliesTags=V),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Z,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":v[9]||(v[9]=V=>o.value.RequiredTags=V),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Le,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":v[10]||(v[10]=V=>o.value.RequiredGroupMemberships=V),convention:a.convention,organisation:a.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups (any one) that a user must be a member of to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),o.value.Type===y(K).TICKET_TYPE_TICKET?(f(),S(A,{key:2},[e(D,{cols:"12"},{default:l(()=>[e(R,{label:"Components Required",type:"number",variant:"outlined",modelValue:o.value.ComponentsRequired,"onUpdate:modelValue":v[11]||(v[11]=V=>o.value.ComponentsRequired=V),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ge,{label:"Components",variant:"outlined",tickets:n.value,modelValue:o.value.TicketComponents,"onUpdate:modelValue":v[12]||(v[12]=V=>o.value.TicketComponents=V),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ge,{label:"Addons",variant:"outlined",tickets:d.value,modelValue:o.value.AddonTickets,"onUpdate:modelValue":v[13]||(v[13]=V=>o.value.AddonTickets=V),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):M("",!0),e(D,{cols:"12"},{default:l(()=>[e(ge,{label:"Disables Tickets",variant:"outlined",tickets:a.tickets,modelValue:o.value.DisablesTickets,"onUpdate:modelValue":v[14]||(v[14]=V=>o.value.DisablesTickets=V),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),u(o.value).length?(f(),C(F,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>v[15]||(v[15]=[N("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1)])),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(Je,null,{default:l(()=>[(f(!0),S(A,null,h(u(o.value),V=>(f(),C(he,{key:V.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[_(O(V.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):M("",!0),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(ee,{onClick:t})]),_:1})]),_:1})]),_:1}))}}),xl={class:"pr-2"},Ml={class:"mb-2"},Pl={key:0,class:"text-grey-darken-1 font-italic"},Ol={key:1,class:"text-red"},$l={key:0,class:"text-grey-darken-1 font-italic"},wl={key:1,class:"text-red"},ql={key:0,class:"text-grey-darken-1 font-italic"},Ll={key:1,class:"text-red"},hl={class:"text-grey-darken-1"},Kl=P({__name:"EditConventionTickets",props:q({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:q(["close"],["update:modelValue"]),setup(g,{emit:m}){const o=w(g,"modelValue"),r=m,p=B(),d=()=>{o.value.push({ID:0,TicketUUID:$(),ConventionID:g.convention.ID,ConventionUUID:g.convention.ConventionUUID,Order:o.value.length+1,Name:"New Ticket",Type:K.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},n=t=>{p.deleteTicket(o.value[t].TicketUUID).then(a=>{a&&o.value.splice(t,1)})},u=t=>t.Type===K.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===K.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===K.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===K.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,a)=>(f(),C(se,null,{default:l(()=>[e(re,{dark:"",color:"primary"},{default:l(()=>[e(me,null,{default:l(()=>a[1]||(a[1]=[_("Edit Tickets")])),_:1}),e(ne),e(Te,null,{default:l(()=>[e(x,{variant:"text",onClick:d},{default:l(()=>a[2]||(a[2]=[_(" Add Ticket ")])),_:1}),e(x,{icon:"",dark:"",onClick:a[0]||(a[0]=v=>r("close"))},{default:l(()=>[e(X,null,{default:l(()=>a[3]||(a[3]=[_("mdi:mdi-close")])),_:1})]),_:1})]),_:1})]),_:1}),e(De,{class:"pa-0"},{default:l(()=>[e(pe,null,{default:l(()=>[(f(!0),S(A,null,h(o.value,(v,V)=>(f(),C(fe,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ve,{class:"py-2"},{actions:l(({expanded:U})=>[e(ee,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:s=>n(V)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:U?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(x,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:oe(U=>y($e)(v,o.value),["stop"])},null,8,["onClick"]),e(x,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:oe(U=>y(we)(v,o.value),["stop"])},null,8,["onClick"]),N("div",xl,[e(X,{icon:u(v)},null,8,["icon"])]),N("div",null,[N("p",Ml,[_(O(v.Name)+" ",1),v.Type===y(K).TICKET_TYPE_TICKET?(f(),S(A,{key:0},[o.value.find(U=>U.Type===y(K).TICKET_TYPE_GROUP&&U.Tickets.find(s=>s&&s.TicketUUID===v.TicketUUID))?(f(),S("span",Pl," ("+O(o.value.filter(U=>U.Type===y(K).TICKET_TYPE_GROUP&&U.Tickets.find(s=>s&&s.TicketUUID===v.TicketUUID)).map(U=>U.Name).join(", "))+") ",1)):(f(),S("span",Ol," (Ticket does not belong to any categories.) "))],64)):M("",!0),v.Type===y(K).TICKET_TYPE_ADD_ON?(f(),S(A,{key:1},[o.value.find(U=>U.Type===y(K).TICKET_TYPE_TICKET&&U.AddonTickets.find(s=>s&&s.TicketUUID===v.TicketUUID))?(f(),S("span",$l," ("+O(o.value.filter(U=>U.Type===y(K).TICKET_TYPE_TICKET&&U.AddonTickets.find(s=>s&&s.TicketUUID===v.TicketUUID)).map(U=>U.Name).join(", "))+") ",1)):(f(),S("span",wl," (Ticket addon must be associated to at least one ticket.) "))],64)):M("",!0),v.Type===y(K).TICKET_TYPE_TICKET_COMPONENT?(f(),S(A,{key:2},[o.value.find(U=>U.Type===y(K).TICKET_TYPE_TICKET&&U.TicketComponents.find(s=>s&&s.TicketUUID===v.TicketUUID))?(f(),S("span",ql," ("+O(o.value.filter(U=>U.Type===y(K).TICKET_TYPE_TICKET&&U.TicketComponents.find(s=>s&&s.TicketUUID===v.TicketUUID)).map(U=>U.Name).join(", "))+") ",1)):(f(),S("span",Ll," (Component has not been assigned to any tickets.) "))],64)):M("",!0)]),N("p",hl,[v.Type===y(K).TICKET_TYPE_GROUP?(f(),S(A,{key:0},[_("Category")],64)):v.Type===y(K).TICKET_TYPE_TICKET?(f(),S(A,{key:1},[a[4]||(a[4]=_(" Ticket ")),v.ComponentsRequired>0?(f(),S(A,{key:0},[_(" ("+O(v.ComponentsRequired)+" component"+O(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):M("",!0)],64)):M("",!0),v.Type===y(K).TICKET_TYPE_TICKET_COMPONENT?(f(),S(A,{key:2},[_("Component")],64)):M("",!0),v.Type===y(K).TICKET_TYPE_ADD_ON?(f(),S(A,{key:3},[_("Addon")],64)):M("",!0)])])]),_:2},1024),e(ce,{class:"px-0"},{default:l(()=>[e(Rl,{accommodation:t.accommodation,convention:t.convention,tickets:o.value,modelValue:o.value[V],"onUpdate:modelValue":U=>o.value[V]=U},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Gl=P({__name:"Tickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(g){var V;const m=w(g,"modelValue"),o=B(),r=b([]),p=b([]);o.getConventionTickets(((V=m.value)==null?void 0:V.ConventionUUID)||"").then(U=>{je(U),r.value=U});const d=b([""]),n=b(!1),u=U=>U.AddonTickets&&U.AddonTickets.map(s=>r.value&&r.value.find(i=>i.ID===s.ID)),t=U=>U.TicketComponents&&U.TicketComponents.map(s=>r.value&&r.value.find(i=>i.ID===s.ID)),a=U=>"",v=U=>p.value.filter(s=>s.Costs.find(i=>i.DateStart===U.DateStart&&i.DateEnd===U.DateEnd)).map(s=>s.Name).join(", ");return(U,s)=>(f(),S(A,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>s[5]||(s[5]=[N("h3",null,"Tickets",-1)])),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(x,{color:"primary",onClick:s[0]||(s[0]=i=>n.value=!0)},{default:l(()=>s[6]||(s[6]=[_("Edit")])),_:1})]),_:1})]),_:1})]),_:1}),s[7]||(s[7]=N("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1)),e(Ne,{opened:d.value,"onUpdate:opened":s[1]||(s[1]=i=>d.value=i)},{default:l(()=>[(f(!0),S(A,null,h(r.value.filter(i=>i.Type===y(K).TICKET_TYPE_GROUP),i=>(f(),C(Re,{key:i.ID,value:i.ID},{activator:l(({props:c})=>[e(ie,Ce({ref_for:!0},c,{"prepend-icon":"mdi:mdi-group",title:i.Name}),null,16,["title"])]),default:l(()=>[(f(!0),S(A,null,h(r.value.filter(c=>i.Tickets.find(I=>I&&c&&I.TicketUUID===c.TicketUUID)),c=>(f(),S(A,{key:c.ID},[c.AddonTickets&&c.AddonTickets.length?(f(),C(Re,{key:0,value:c.ID},{activator:l(({props:I})=>[e(ie,Ce({ref_for:!0},I,{"prepend-icon":c.RequiresAccommodation?"mdi:mdi-home":c.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${c.Name} ${c.Price>0?`(${y(L).currencySymbol}${c.Price})`:""}`}),{default:l(()=>[c.ComponentsRequired>0?(f(),C(te,{key:0},{default:l(()=>[_(" Options: "+O(t(c).map(k=>k&&k.Name).join(", ")),1)]),_:2},1024)):M("",!0),c.RequiresAccommodation&&v(c)?(f(),C(te,{key:1},{default:l(()=>[_(" Accommodation: "+O(v(c)),1)]),_:2},1024)):M("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(f(!0),S(A,null,h(u(c),I=>(f(),S(A,{key:I},[I?(f(),C(ie,{key:0,title:`${I.Name} ${I.Price>0?`(${y(L).currencySymbol}${I.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[I.RequiredTags&&I.RequiredTags.length>0?(f(),C(te,{key:0},{default:l(()=>[_(" Required Tags: "+O(I.RequiredTags.join(", ")),1)]),_:2},1024)):M("",!0),I.RequiredGroupMemberships&&I.RequiredGroupMemberships.length>0?(f(),C(te,{key:1},{default:l(()=>[_(" Required Groups: "+O(a(I.RequiredGroupMemberships)),1)]),_:2},1024)):M("",!0),v(I)?(f(),C(te,{key:2},{default:l(()=>[_(" Accommodation: "+O(v(I)),1)]),_:2},1024)):M("",!0)]),_:2},1032,["title"])):M("",!0)],64))),128))]),_:2},1032,["value"])):(f(),C(ie,{key:1,"prepend-icon":c.RequiresAccommodation?"mdi:mdi-home":c.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${c.Name} ${c.Price>0?`(${y(L).currencySymbol}${c.Price})`:""}`},{default:l(()=>[c.ComponentsRequired>0?(f(),C(te,{key:0},{default:l(()=>[_(" Options: "+O(t(c).map(I=>I&&I.Name).join(", ")),1)]),_:2},1024)):M("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Ie,{modelValue:n.value,"onUpdate:modelValue":s[4]||(s[4]=i=>n.value=i),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(Kl,{onClose:s[2]||(s[2]=i=>n.value=!1),modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=i=>r.value=i),accommodation:p.value,convention:m.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Bl=P({__name:"VenueRoomCost",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["deleted"],["update:modelValue"]),setup(g,{emit:m}){const o=m,r=w(g,"modelValue"),p=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],d=()=>{o("deleted")};return(n,u)=>(f(),C(F,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:y(L).formLabelDateStart,type:"date",variant:"outlined",modelValue:r.value.DateStart,"onUpdate:modelValue":u[0]||(u[0]=t=>r.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:y(L).formLabelDateEnd,type:"date",variant:"outlined",modelValue:r.value.DateEnd,"onUpdate:modelValue":u[1]||(u[1]=t=>r.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:y(L).formLabelAvailability,type:"number",variant:"outlined",modelValue:r.value.Availability,"onUpdate:modelValue":u[2]||(u[2]=t=>r.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:y(L).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:r.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>r.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(W,{label:y(L).formLabelPriceType,variant:"outlined",modelValue:r.value.Type,"onUpdate:modelValue":u[4]||(u[4]=t=>r.value.Type=t),items:p,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(x,{color:"red",icon:"mdi:mdi-minus",onClick:d})]),_:1})]),_:1}))}}),Yl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},Hl=P({__name:"VenueRoom",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["deleted"],["update:modelValue"]),setup(g,{emit:m}){const o=B(),r=m,p=b(L),d=w(g,"modelValue"),n=b(H(d.value)),u=b(!1),t=s=>{switch(s.Type){case _e.PER_PERSON:return p.value.enumPER_PERSON;case _e.PER_ROOM:return p.value.enumPER_ROOM}return"Unknown"},a=()=>{n.value.Costs||(n.value.Costs=[]),n.value.Costs.push({ID:0,CostUUID:$(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=s=>{n.value.Costs.splice(s,1)},V=({callback:s})=>{const i=()=>{s&&s("Failed to Delete Room")},c=()=>{s&&s("Room Deleted")};o.deleteRoom(n.value.RoomUUID).then(I=>{I?(c(),r("deleted",n.value)):i()}).catch(()=>{i()})},U=()=>{o.saveRoom(n.value).then(()=>{d.value=n.value,u.value=!1})};return(s,i)=>(f(),S(A,null,[e(z,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[N("h4",null,O(n.value.Name),1),N("p",null,O(n.value.Notes),1),N("p",null,[i[7]||(i[7]=N("strong",null,"Capacity:",-1)),_(" "+O(n.value.MinimumCapacity)+" ",1),n.value.MinimumCapacity!=n.value.MaximumCapacity?(f(),S(A,{key:0},[_(" - "+O(n.value.MaximumCapacity),1)],64)):M("",!0)]),e(ml,{density:"compact"},{default:l(()=>[i[8]||(i[8]=N("thead",null,[N("tr",null,[N("th",null,"Date"),N("th",null,"Price"),N("th",null,"Availability")])],-1)),N("tbody",null,[(f(!0),S(A,null,h(n.value.Costs,c=>(f(),S("tr",{key:`venue-room-${n.value.ID}-cost-${c.ID}`},[N("td",null,O(c.DateStart)+" - "+O(c.DateEnd),1),N("td",null,O(p.value.currencySymbol)+O(c.Price)+" "+O(t(c)),1),N("td",null,O(c.Availability),1)]))),128))])]),_:1}),N("div",Yl,[e(x,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:i[0]||(i[0]=c=>u.value=!0)},{default:l(()=>i[9]||(i[9]=[_("Edit Room")])),_:1}),e(ee,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:V},{default:l(()=>i[10]||(i[10]=[_("Delete Room")])),_:1})])]),_:1}),e(Ie,{scrollable:"",modelValue:u.value,"onUpdate:modelValue":i[6]||(i[6]=c=>u.value=c),width:"auto"},{default:l(()=>[e(se,null,{default:l(()=>[e(re,{dark:"",color:"primary"},{default:l(()=>[e(x,{icon:"",dark:"",onClick:i[1]||(i[1]=c=>u.value=!1)},{default:l(()=>[e(X,null,{default:l(()=>i[11]||(i[11]=[_("mdi:mdi-close")])),_:1})]),_:1}),e(me,null,{default:l(()=>[_("Room Details ("+O(n.value.Name)+")",1)]),_:1}),e(ne),e(Te,null,{default:l(()=>[e(x,{variant:"text",onClick:U},{default:l(()=>i[12]||(i[12]=[_(" Save ")])),_:1})]),_:1})]),_:1}),e(De,null,{default:l(()=>[e(le,null,{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(R,{label:p.value.formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":i[2]||(i[2]=c=>n.value.Name=c)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(ve,{label:p.value.formLabelNotes,variant:"outlined",modelValue:n.value.Notes,"onUpdate:modelValue":i[3]||(i[3]=c=>n.value.Notes=c)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{type:"number",label:p.value.formLabelMinimumCapacity,variant:"outlined",modelValue:n.value.MinimumCapacity,"onUpdate:modelValue":i[4]||(i[4]=c=>n.value.MinimumCapacity=c),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{type:"number",label:p.value.formLabelMaximumCapacity,variant:"outlined",modelValue:n.value.MaximumCapacity,"onUpdate:modelValue":i[5]||(i[5]=c=>n.value.MaximumCapacity=c),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>i[13]||(i[13]=[N("h4",null," Availability & Costs (To Organisation) ",-1)])),_:1})]),_:1}),(f(!0),S(A,null,h(n.value.Costs,(c,I)=>(f(),S(A,{key:`venue-room-${n.value.ID}-cost-${c.ID}`},[n.value.Costs&&n.value.Costs[I]?(f(),C(Bl,{key:0,modelValue:n.value.Costs[I],"onUpdate:modelValue":k=>n.value.Costs[I]=k,onDeleted:k=>v(I)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):M("",!0)],64))),128)),e(x,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:a},{default:l(()=>i[14]||(i[14]=[_("Add Row")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),jl=P({__name:"Venue",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["deleted"],["update:modelValue"]),setup(g,{emit:m}){const o=B(),r=m,p=w(g,"modelValue"),d=b(H(p.value)),n=b([]),u=b(!1),t=b(!1);o.getVenueRooms(d.value.VenueUUID).then(s=>{n.value=s}),Q(d.value,()=>{t.value=!0});const a=({callback:s})=>{u.value=!0,o.saveVenue(d.value).then(()=>{u.value=!1,t.value=!1,p.value=d.value,s&&s("Venue Saved")}).catch(()=>{u.value=!1,s&&s("Failed to Saved Venue")})},v=({callback:s})=>{u.value=!0,o.deleteVenue(d.value.VenueUUID).then(i=>{u.value=!1,i?s&&(s("Venue Deleted"),r("deleted")):s&&s("Failed to Delete Venue")}).catch(()=>{s&&(s("Failed to Delete Venue"),u.value=!1)})},V=()=>{const s={ID:0,RoomUUID:$(),VenueID:d.value.ID,VenueUUID:d.value.VenueUUID,Order:n.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};o.saveRoom(s).then(i=>{i&&n.value.push(i)})},U=(s,i)=>{o.deleteRoom(n.value[i].RoomUUID).then(c=>{c&&n.value.splice(i,1)})};return(s,i)=>(f(),C(fe,null,{default:l(()=>[e(Ve,null,{default:l(()=>[_(O(d.value.Name),1)]),_:1}),e(ce,null,{default:l(()=>[e(F,{"no-gutters":""},{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(R,{label:y(L).formLabelName,name:"name",variant:"outlined",modelValue:d.value.Name,"onUpdate:modelValue":i[0]||(i[0]=c=>d.value.Name=c)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ve,{label:y(L).formLabelDescription,name:"description",variant:"outlined",modelValue:d.value.Description,"onUpdate:modelValue":i[1]||(i[1]=c=>d.value.Description=c)},null,8,["label","modelValue"])]),_:1}),e(D,{class:"text-right",cols:"12"},{default:l(()=>[e(ee,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(ee,{enabled:t.value,timeout:"7",onClick:a},null,8,["enabled"])]),_:1})]),_:1}),i[3]||(i[3]=N("h3",null,"Rooms",-1)),(f(!0),S(A,null,h(n.value,(c,I)=>(f(),C(le,{variant:"elevation",elevation:"6",key:`venue-room-${c.ID}`},{default:l(()=>[n.value&&n.value[I]?(f(),C(Hl,{key:0,modelValue:n.value[I],"onUpdate:modelValue":k=>n.value[I]=k,onDeleted:k=>U(k,I)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):M("",!0)]),_:2},1024))),128)),e(le,{class:"ma-2"},{default:l(()=>[e(x,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:V},{default:l(()=>i[2]||(i[2]=[_("Add Room")])),_:1})]),_:1})]),_:1})]),_:1}))}}),zl=P({__name:"VenuesEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["close","pageTitle","refresh"],["update:modelValue"]),setup(g,{emit:m}){const o=B(),r=m,p=w(g,"modelValue");r("pageTitle","Venues");const d=b([]);o.getConventionVenues(p.value.ConventionUUID).then(t=>{d.value=t});const n=()=>{const t={ID:0,VenueUUID:$(),ConventionID:p.value.ID,ConventionUUID:p.value.ConventionUUID,Order:d.value.length+1,Name:"New Venue",Description:"",Rooms:[]};o.saveVenue(t).then(a=>{a&&d.value.push(a)})},u=t=>{d.value.splice(t,1)};return(t,a)=>(f(),S(A,null,[e(z,{fluid:"",class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>a[0]||(a[0]=[N("h3",null,"Venues",-1)])),_:1})]),_:1})]),_:1}),a[2]||(a[2]=N("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1)),a[3]||(a[3]=N("p",null," Attendee options are configured via the accommodation tab. ",-1)),e(le,null,{default:l(()=>[e(pe,{variant:"accordion"},{default:l(()=>[(f(!0),S(A,null,h(d.value,(v,V)=>(f(),C(jl,{key:`venues-${v.ID}`,modelValue:d.value[V],"onUpdate:modelValue":U=>d.value[V]=U,onDeleted:U=>u(V)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(le,{class:"pa-2"},{default:l(()=>[e(x,{color:"primary",onClick:n},{default:l(()=>a[1]||(a[1]=[_("Add Venue")])),_:1})]),_:1})]),_:1})],64))}}),Jl=P({__name:"AccommodationCost",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["deleted"],["update:modelValue"]),setup(g,{emit:m}){const o=m,r=w(g,"modelValue"),p=b([]);B().getConventionTickets(g.convention.ConventionUUID).then(a=>{a&&(p.value=a)});const n=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],u=()=>{o("deleted")},t=ae(()=>p.value.filter(a=>(a.Type===K.TICKET_TYPE_TICKET||a.Type===K.TICKET_TYPE_ADD_ON)&&a.RequiresAccommodation&&a.DateStart===r.value.DateStart&&a.DateEnd===r.value.DateEnd));return(a,v)=>(f(),S(A,null,[e(F,{class:"align-center",dense:""},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>v[4]||(v[4]=[N("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1)])),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(Je,null,{default:l(()=>[(f(!0),S(A,null,h(t.value,V=>(f(),C(he,{key:V.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[_(O(V.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(F,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(R,{label:y(L).formLabelDateStart,type:"date",variant:"outlined",modelValue:r.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=V=>r.value.DateStart=V)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(R,{label:y(L).formLabelDateEnd,type:"date",variant:"outlined",modelValue:r.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=V=>r.value.DateEnd=V)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(R,{label:y(L).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:r.value.Price,"onUpdate:modelValue":v[2]||(v[2]=V=>r.value.Price=V),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(W,{label:y(L).formLabelPriceType,variant:"outlined",modelValue:r.value.Type,"onUpdate:modelValue":v[3]||(v[3]=V=>r.value.Type=V),items:n,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(x,{color:"red",icon:"mdi:mdi-minus",onClick:u})]),_:1})]),_:1})],64))}}),Wl=P({__name:"Accommodation",props:q({convention:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:q(["deleted"],["update:modelValue"]),setup(g,{emit:m}){const o=B(),r=m,p=w(g,"modelValue"),d=b(H(p.value)),n=ae(()=>g.venues.map(V=>V.Rooms.map(U=>({title:` ${V.Name} - ${U.Name}`,value:U}))).flat()),u=()=>{d.value.Costs||(d.value.Costs=[]),d.value.Costs.push({ID:0,CostUUID:$(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:_e.PER_ROOM})},t=V=>{d.value.Costs.splice(V,1)},a=({callback:V})=>{o.deleteAccommodation(d.value.AccommodationUUID).then(U=>{U?V&&(V("Accommodation Deleted"),r("deleted")):V&&V("Failed to Delete Accommodation")}).catch(()=>{V&&V("Failed to Delete Accommodation")})},v=({callback:V})=>{o.saveAccommodation(d.value).then(U=>{U?(d.value.ID=U.ID,p.value=U,V&&V("Accommodation Saved")):V&&V("Failed to Save Accommodation")}).catch(()=>{V&&V("Failed to Save Accommodation")})};return(V,U)=>(f(),C(fe,null,{default:l(()=>[e(Ve,null,{default:l(()=>[_(O(d.value.Name),1)]),_:1}),e(ce,null,{default:l(()=>[e(le,null,{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(R,{modelValue:d.value.Name,"onUpdate:modelValue":U[0]||(U[0]=s=>d.value.Name=s),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[U[3]||(U[3]=N("h4",null," Room Pool ",-1)),U[4]||(U[4]=N("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1)),e(W,{clearable:!0,modelValue:d.value.Pool,"onUpdate:modelValue":U[1]||(U[1]=s=>d.value.Pool=s),items:n.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),U[5]||(U[5]=N("p",null," Pool total: ",-1)),N("p",null,[e(Z,{label:"Required Tags",variant:"outlined",modelValue:d.value.RequiredTags,"onUpdate:modelValue":U[2]||(U[2]=s=>d.value.RequiredTags=s),convention:V.convention,organisation:V.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),U[6]||(U[6]=N("h4",null," Accommodation Costs ",-1)),U[7]||(U[7]=N("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1)),d.value.Costs?(f(!0),S(A,{key:0},h(d.value.Costs,(s,i)=>(f(),C(Jl,{key:`venue-room-${d.value.ID}-cost-${s.ID}`,convention:V.convention,modelValue:d.value.Costs[i],"onUpdate:modelValue":c=>d.value.Costs[i]=c,onDeleted:c=>t(i)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):M("",!0)]),_:1})]),_:1}),e(F,{"no-gutters":""},{default:l(()=>[e(D,{class:"text-left"},{default:l(()=>[e(x,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:u},{default:l(()=>U[8]||(U[8]=[_("Add Row")])),_:1})]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(ee,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:a}),e(ee,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Xl=P({__name:"AccommodationEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=B(),o=w(g,"modelValue"),r=b([]),p=b([]);m.getConventionAccommodation(o.value.ConventionUUID).then(u=>{u&&(r.value=u)}),m.getConventionVenues(o.value.ConventionUUID).then(u=>{u&&(p.value=u)});const d=()=>{const u={ID:0,AccommodationUUID:$(),ConventionID:o.value.ID,ConventionUUID:o.value.ConventionUUID,Order:r.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};m.saveAccommodation(u).then(t=>{t&&r.value.push(t)})},n=u=>{r.value.splice(u,1)};return(u,t)=>(f(),S(A,null,[e(z,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>t[0]||(t[0]=[N("h3",null,"Accommodation",-1)])),_:1})]),_:1})]),_:1}),t[2]||(t[2]=N("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1)),t[3]||(t[3]=N("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1)),e(le,null,{default:l(()=>[e(pe,{variant:"accordion"},{default:l(()=>[(f(!0),S(A,null,h(r.value,(a,v)=>(f(),C(Wl,{key:a.AccommodationUUID,convention:o.value,venues:p.value,modelValue:r.value[v],"onUpdate:modelValue":V=>r.value[v]=V,onDeleted:V=>n(v)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(le,{class:"pa-2"},{default:l(()=>[e(x,{color:"primary",onClick:d},{default:l(()=>t[1]||(t[1]=[_("Add Accommodation")])),_:1})]),_:1})]),_:1})],64))}}),Zl=P({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=Se.getInstance(),r=b([]),p=b([]);return o==null||o.getConventionExtras(m.value.ConventionUUID).then(d=>{r.value=d;const n=m.value.Values.find(u=>u.Title==="SelectedExtras");if(n)try{p.value=JSON.parse(n.Value)}catch{}}),Q(p,()=>{const d=m.value.Values.find(n=>n.Title==="SelectedExtras");if(d)d.Value=JSON.stringify(p.value);else{const n={ID:0,FieldValueUUID:$(),FieldID:m.value.ID,FieldUUID:m.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(p.value)};m.value.Values.push(n)}}),(d,n)=>(f(!0),S(A,null,h(r.value,u=>(f(),C(j,{key:u.ExtraUUID,modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=t=>p.value=t),label:u.Name,value:u.ExtraUUID,name:m.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),Ql=P({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=Se.getInstance(),r=b([]),p=b([]);return o==null||o.getConventionInterests(m.value.ConventionUUID).then(d=>{r.value=d;const n=m.value.Values.find(u=>u.Title==="SelectedInterests");if(n)try{p.value=JSON.parse(n.Value)}catch{}}),Q(p,()=>{const d=m.value.Values.find(n=>n.Title==="SelectedInterests");if(d)d.Value=JSON.stringify(p.value);else{const n={ID:0,FieldValueUUID:$(),FieldID:m.value.ID,FieldUUID:m.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(p.value)};m.value.Values.push(n)}}),(d,n)=>(f(!0),S(A,null,h(r.value,u=>(f(),C(j,{key:u.InterestUUID,modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=t=>p.value=t),label:u.Name,value:u.InterestUUID,name:m.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),et=P({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=Se.getInstance(),r=b([]),p=b([]);return o==null||o.getConventionTickets(m.value.ConventionUUID).then(d=>{r.value=d;const n=m.value.Values.find(u=>u.Title==="SelectedTickets");if(n)try{p.value=JSON.parse(n.Value)}catch{}}),Q(p,()=>{const d=m.value.Values.find(n=>n.Title==="SelectedTickets");if(d)d.Value=JSON.stringify(p.value);else{const n={ID:0,FieldValueUUID:$(),FieldID:m.value.ID,FieldUUID:m.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(p.value)};m.value.Values.push(n)}}),(d,n)=>(f(!0),S(A,null,h(r.value.filter(u=>u&&u.Type===y(K).TICKET_TYPE_GROUP),u=>(f(),C(j,{key:u.TicketUUID,modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=t=>p.value=t),label:u.Name,value:u.TicketUUID,name:m.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),lt=P({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=Se.getInstance(),r=b([]),p=b(m.value.Values.map(u=>u.Value)),d=b({sharing:!1});try{const u=JSON.parse(m.value.Data);u&&(d.value=u)}catch{}const n=()=>{m.value.Data=JSON.stringify(d.value),m.value.Values=p.value.map(u=>{var t,a,v;return{ID:0,FieldValueUUID:$(),FieldID:((t=m.value)==null?void 0:t.ID)||0,FieldUUID:((a=m.value)==null?void 0:a.FieldUUID)||"",Title:((v=r.value.find(V=>V.AccommodationUUID==u))==null?void 0:v.Name)||"",Value:u}})};return o==null||o.getConventionAccommodation(m.value.ConventionUUID).then(u=>{u&&(r.value=u)}),(u,t)=>(f(),S(A,null,[t[2]||(t[2]=N("h5",null,"Display Options",-1)),e(j,{label:"Show Sharing Options",modelValue:d.value.sharing,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value.sharing=a),"hide-details":"",onChange:n},null,8,["modelValue"]),t[3]||(t[3]=N("h5",null,"Accommodation Choices",-1)),(f(!0),S(A,null,h(r.value,a=>(f(),C(j,{key:a.ID,modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=v=>p.value=v),label:a.Name,value:a.AccommodationUUID,"hide-details":"",onChange:n},null,8,["modelValue","label","value"]))),128))],64))}}),tt=P({__name:"EditFieldDialogAge",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){var v,V,U;const m=w(g,"modelValue"),o=new Date,r=o.getFullYear(),p=(o.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),d=o.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),n=b(parseInt(((v=m.value.Values.find(s=>s.Title==="MIN_AGE"))==null?void 0:v.Value)||"18")),u=b(((V=m.value.Values.find(s=>s.Title==="BEFORE_DATE"))==null?void 0:V.Value)||`${r}-${p}-${d}`),t=b(((U=m.value.Values.find(s=>s.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:U.Value)||""),a=()=>{var s,i,c,I,k,T;m.value.Values=[{ID:0,FieldValueUUID:$(),FieldID:((s=m.value)==null?void 0:s.ID)||0,FieldUUID:((i=m.value)==null?void 0:i.FieldUUID)||"",Title:"MIN_AGE",Value:n.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((c=m.value)==null?void 0:c.ID)||0,FieldUUID:((I=m.value)==null?void 0:I.FieldUUID)||"",Title:"BEFORE_DATE",Value:u.value},{ID:0,FieldValueUUID:$(),FieldID:((k=m.value)==null?void 0:k.ID)||0,FieldUUID:((T=m.value)==null?void 0:T.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:t.value}]};return a(),(s,i)=>(f(),C(z,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=c=>n.value=c),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:a},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:u.value,"onUpdate:modelValue":i[1]||(i[1]=c=>u.value=c),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:a},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(Z,{modelValue:t.value,"onUpdate:modelValue":i[2]||(i[2]=c=>t.value=c),convention:s.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${n.value} at time of data entry`,onChange:a},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),at=P({__name:"EditFieldDialogHTML",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=b({html:""});try{const p=JSON.parse(m.value.Data);p&&(o.value=p)}catch{}const r=()=>{m.value.Data=JSON.stringify(o.value)};return(p,d)=>(f(),C(ve,{variant:"outlined",label:"Raw HTML",modelValue:o.value.html,"onUpdate:modelValue":d[0]||(d[0]=n=>o.value.html=n),onKeydown:r,onChange:r},null,8,["modelValue"]))}}),ot=P({__name:"EditFieldDialogBadgeImage",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=b({charge:0,free:0,height:0,label:!1,maximum:0,tags:[],width:0});try{o.value=vl(m.value.Data)}catch{}const r=()=>{m.value.Data=JSON.stringify(o.value)};return(p,d)=>(f(),S(A,null,[d[7]||(d[7]=N("h5",{class:"my-2"},"Tags & Labels",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(Z,{label:"Badge Tags",variant:"outlined",modelValue:o.value.tags,"onUpdate:modelValue":d[0]||(d[0]=n=>o.value.tags=n),convention:m.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that apply to this badge.","input-type":y(il).UUID_ARRAY,onChange:r},null,8,["modelValue","convention","input-type"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(j,{modelValue:o.value.label,"onUpdate:modelValue":d[1]||(d[1]=n=>o.value.label=n),label:"Allow Custom Label",variant:"outlined","hide-details":"",onChange:r},null,8,["modelValue"])]),_:1})]),_:1}),d[8]||(d[8]=N("h5",{class:"my-2"},"Dimensions",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:o.value.width,"onUpdate:modelValue":d[2]||(d[2]=n=>o.value.width=n),modelModifiers:{number:!0},label:"Width",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:r},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:o.value.height,"onUpdate:modelValue":d[3]||(d[3]=n=>o.value.height=n),modelModifiers:{number:!0},label:"Height",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:r},null,8,["modelValue"])]),_:1})]),_:1}),d[9]||(d[9]=N("h5",{class:"my-2"},"Limits",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:o.value.maximum,"onUpdate:modelValue":d[4]||(d[4]=n=>o.value.maximum=n),modelModifiers:{number:!0},label:"Maximum Badges",hint:"Zero = Unlimited",variant:"outlined",type:"number",min:"0",onChange:r},null,8,["modelValue"])]),_:1})]),_:1}),d[10]||(d[10]=N("h5",{class:"my-2"},"Costs",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:o.value.charge,"onUpdate:modelValue":d[5]||(d[5]=n=>o.value.charge=n),modelModifiers:{number:!0},label:"Charge Per Badge",prefix:y(L).currencySymbol,variant:"outlined","hide-details":"",type:"number",min:"0",onChange:r},null,8,["modelValue","prefix"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:o.value.free,"onUpdate:modelValue":d[6]||(d[6]=n=>o.value.free=n),modelModifiers:{number:!0},label:"Free Badges",variant:"outlined","hide-details":"",type:"number",min:"0",onChange:r},null,8,["modelValue"])]),_:1})]),_:1})],64))}}),nt=P({__name:"EditFieldDialogConfirmation",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){var u,t,a,v;const m=w(g,"modelValue"),o=b(((u=m.value.Values.find(V=>V.Title==="MATCH_STRING"))==null?void 0:u.Value)||""),r=b(((t=m.value.Values.find(V=>V.Title==="CASE_SENSITIVE"))==null?void 0:t.Value)=="true"||!1),p=b(((a=m.value.Values.find(V=>V.Title==="MUST_MATCH"))==null?void 0:a.Value)=="true"||!1),d=b(((v=m.value.Values.find(V=>V.Title==="MATCHED_APPLY_TAGS"))==null?void 0:v.Value)||""),n=()=>{var V,U,s,i,c,I,k,T;m.value.Values=[{ID:0,FieldValueUUID:$(),FieldID:((V=m.value)==null?void 0:V.ID)||0,FieldUUID:((U=m.value)==null?void 0:U.FieldUUID)||"",Title:"MATCH_STRING",Value:o.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((s=m.value)==null?void 0:s.ID)||0,FieldUUID:((i=m.value)==null?void 0:i.FieldUUID)||"",Title:"CASE_SENSITIVE",Value:r.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((c=m.value)==null?void 0:c.ID)||0,FieldUUID:((I=m.value)==null?void 0:I.FieldUUID)||"",Title:"MUST_MATCH",Value:p.value.toString()},{ID:0,FieldValueUUID:$(),FieldID:((k=m.value)==null?void 0:k.ID)||0,FieldUUID:((T=m.value)==null?void 0:T.FieldUUID)||"",Title:"MATCHED_APPLY_TAGS",Value:d.value}]};return n(),(V,U)=>(f(),C(z,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:o.value,"onUpdate:modelValue":U[0]||(U[0]=s=>o.value=s),type:"text",label:"Text that must be entered","hide-details":"",variant:"outlined",onChange:n},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(Z,{modelValue:d.value,"onUpdate:modelValue":U[1]||(U[1]=s=>d.value=s),convention:V.convention,chips:!0,clearable:!0,variant:"outlined",label:"Tags applied to users that entered the correct text",onChange:n},null,8,["modelValue","convention"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(j,{modelValue:r.value,"onUpdate:modelValue":U[2]||(U[2]=s=>r.value=s),label:"Case sensitive","hide-details":"",variant:"outlined",onChange:n},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(j,{modelValue:p.value,"onUpdate:modelValue":U[3]||(U[3]=s=>p.value=s),label:"Field must match text to proceed","hide-details":"",variant:"outlined",onChange:n},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}}),ut={key:0},it={key:1},dt=P({__name:"EditFieldDialog",props:q({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:q(["update:field"],["update:modelValue"]),setup(g,{emit:m}){const o=g,{convention:r,title:p=""}=o,d=m,n=w(g,"modelValue"),u=de(o,d,void 0,void 0,"field"),t=b(H(u.value)),a=b(""),v=b(t.value.Type);Q(u,()=>{t.value=H(u.value)});const V=()=>{n.value=!1},U=()=>{t.value=H(u.value)},s=()=>{u.value=t.value},i=()=>{t.value.Values.push({ID:0,FieldValueUUID:$(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},c=k=>{t.value.Values.splice(k,1)},I=()=>{a.value="",t.value.Values=[]};return Q(v,(k,T)=>{k!==T&&(t.value.Type=k,I())}),(k,T)=>(f(),C(Ge,{modelValue:n.value,"onUpdate:modelValue":T[17]||(T[17]=E=>n.value=E),onReset:U,onSave:s,title:y(p),color:"primary",persistent:!0,fullscreen:!0},{default:l(()=>[e(z,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(z,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Name,"onUpdate:modelValue":T[0]||(T[0]=E=>t.value.Name=E),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Label,"onUpdate:modelValue":T[1]||(T[1]=E=>t.value.Label=E),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Hint,"onUpdate:modelValue":T[2]||(T[2]=E=>t.value.Hint=E),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Placeholder,"onUpdate:modelValue":T[3]||(T[3]=E=>t.value.Placeholder=E),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(W,{modelValue:v.value,"onUpdate:modelValue":T[4]||(T[4]=E=>v.value=E),label:"Type",variant:"outlined",items:y(We),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===y(Y).SELECT||t.value.Type===y(Y).CHECKBOX||t.value.Type===y(Y).BADGE_IMAGE?(f(),C(D,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[t.value.Type===y(Y).SELECT||t.value.Type===y(Y).CHECKBOX?(f(),C(j,{key:0,modelValue:t.value.Multiple,"onUpdate:modelValue":T[5]||(T[5]=E=>t.value.Multiple=E),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"])):t.value.Type===y(Y).BADGE_IMAGE?(f(),C(j,{key:1,modelValue:t.value.Multiple,"onUpdate:modelValue":T[6]||(T[6]=E=>t.value.Multiple=E),label:"Custom Fields",hint:"Enable additional badge fields","hide-details":""},null,8,["modelValue"])):M("",!0),t.value.Type===y(Y).SELECT?(f(),C(j,{key:2,modelValue:t.value.Autofill,"onUpdate:modelValue":T[7]||(T[7]=E=>t.value.Autofill=E),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):M("",!0)]),_:1})):M("",!0)]),_:1}),t.value.Type===y(Y).BADGE_IMAGE?(f(),C(F,{key:0},{default:l(()=>[e(D,null,{default:l(()=>[T[18]||(T[18]=N("h4",null,"Badge Image Options",-1)),e(ot,{modelValue:t.value,"onUpdate:modelValue":T[8]||(T[8]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):M("",!0),t.value.Type===y(Y).SELECT||t.value.Type===y(Y).CHECKBOX&&t.value.Multiple||t.value.Type===y(Y).RADIO||t.value.Type===y(Y).BADGE_IMAGE&&t.value.Multiple?(f(),C(F,{key:1},{default:l(()=>[e(D,null,{default:l(()=>[t.value.Type===y(Y).BADGE_IMAGE?(f(),S("h4",ut,"Custom Fields")):(f(),S("h4",it,"Values")),e(z,{fluid:!0,class:"px-0"},{default:l(()=>[(f(!0),S(A,null,h(t.value.Values,(E,G)=>(f(),C(F,{key:E.ID},{default:l(()=>[e(D,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(R,{modelValue:E.Title,"onUpdate:modelValue":J=>E.Title=J,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(R,{modelValue:E.Value,"onUpdate:modelValue":J=>E.Value=J,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(x,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:J=>c(G)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(x,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:i},{default:l(()=>T[19]||(T[19]=[_("Add Item")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===y(Y).ACCOMMODATION?(f(),C(F,{key:2},{default:l(()=>[e(D,null,{default:l(()=>[T[20]||(T[20]=N("h4",null,"Accommodation",-1)),e(lt,{modelValue:t.value,"onUpdate:modelValue":T[9]||(T[9]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).AGE?(f(),C(F,{key:3},{default:l(()=>[e(D,null,{default:l(()=>[T[21]||(T[21]=N("h4",null,"Age",-1)),e(tt,{modelValue:t.value,"onUpdate:modelValue":T[10]||(T[10]=E=>t.value=E),convention:y(r)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===y(Y).CONFIRMATION?(f(),C(F,{key:4},{default:l(()=>[e(D,null,{default:l(()=>[T[22]||(T[22]=N("h4",null,"Confirmation Field",-1)),e(nt,{modelValue:t.value,"onUpdate:modelValue":T[11]||(T[11]=E=>t.value=E),convention:y(r)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===y(Y).EXTRAS?(f(),C(F,{key:5},{default:l(()=>[e(D,null,{default:l(()=>[T[23]||(T[23]=N("h4",null,"Additional Purchases",-1)),e(Zl,{modelValue:t.value,"onUpdate:modelValue":T[12]||(T[12]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).HTML?(f(),C(F,{key:6},{default:l(()=>[e(D,null,{default:l(()=>[e(at,{modelValue:t.value,"onUpdate:modelValue":T[13]||(T[13]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).INTERESTS?(f(),C(F,{key:7},{default:l(()=>[e(D,null,{default:l(()=>[T[24]||(T[24]=N("h4",null,"Available Interests",-1)),e(Ql,{modelValue:t.value,"onUpdate:modelValue":T[14]||(T[14]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===y(Y).TICKET?(f(),C(F,{key:8},{default:l(()=>[e(D,null,{default:l(()=>[T[25]||(T[25]=N("h4",null,"Tickets",-1)),e(et,{modelValue:t.value,"onUpdate:modelValue":T[15]||(T[15]=E=>t.value=E)},null,8,["modelValue"])]),_:1})]),_:1})):M("",!0)]),_:1})]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(le,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[T[26]||(T[26]=N("h4",{class:"mb-3"},"Field Preview",-1)),e(Xe,{admin:!0,field:t.value,convention:y(r),modelValue:a.value,"onUpdate:modelValue":T[16]||(T[16]=E=>a.value=E)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(x,{color:"blue-darken-1",variant:"text",onClick:V},{default:l(()=>T[27]||(T[27]=[_(" Cancel ")])),_:1}),e(x,{color:"blue-darken-1",variant:"text",onClick:U},{default:l(()=>T[28]||(T[28]=[_(" Reset ")])),_:1}),e(ne),e(x,{color:"blue-darken-1",variant:"text",onClick:s},{default:l(()=>T[29]||(T[29]=[_(" Save ")])),_:1})]),_:1},8,["modelValue","title"]))}}),st=P({__name:"FieldEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(g){const m=w(g,"modelValue"),o=B(),r=b(!1),p=b(!1),d=b([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),n=b([]);o.getConventionFields(m.value.ConventionUUID).then(E=>{E&&(n.value=E)});const u=b(-1),t=b({ID:0,FieldUUID:$(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),a=ae(()=>u.value===-1?"New Field":"Edit Field"),v=()=>({ID:0,FieldUUID:$(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),V=b(v()),U=()=>{V.value.FieldUUID=$(),t.value=Object.assign({},v()),u.value=-1,r.value=!0},s=E=>{u.value=n.value.indexOf(E),t.value=Object.assign({},E),r.value=!0},i=E=>{u.value=n.value.indexOf(E),t.value=Object.assign({},E),p.value=!0},c=()=>{o.deleteField(t.value.FieldUUID).then(E=>{E&&(n.value.splice(u.value,1),k())})},I=()=>{r.value=!1,be(()=>{t.value=Object.assign({},V.value),u.value=-1})},k=()=>{p.value=!1,be(()=>{t.value=Object.assign({},V.value),u.value=-1})},T=()=>{o.saveField(t.value).then(E=>{E&&(u.value>-1?Object.assign(n.value[u.value],E):n.value.push(E),I())})};return(E,G)=>(f(),C(Qe,{headers:d.value,items:n.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(re,{color:"primary"},{default:l(()=>[e(me,null,{default:l(()=>G[3]||(G[3]=[_("Field Editor")])),_:1}),e(Ze,{class:"mx-4",inset:!0,vertical:!0}),e(ne),e(x,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:U},{default:l(()=>G[4]||(G[4]=[_(" New Item ")])),_:1}),e(Ke,{modelValue:p.value,"onUpdate:modelValue":G[0]||(G[0]=J=>p.value=J),onDelete:c},null,8,["modelValue"])]),_:1}),r.value?(f(),C(dt,{key:0,modelValue:r.value,"onUpdate:modelValue":G[1]||(G[1]=J=>r.value=J),field:t.value,"onUpdate:field":[G[2]||(G[2]=J=>t.value=J),T],title:a.value,convention:m.value},null,8,["modelValue","field","title","convention"])):M("",!0)]),"item.actions":l(({item:J})=>[e(X,{size:"small",class:"me-2",onClick:al=>s(J)},{default:l(()=>G[5]||(G[5]=[_(" mdi:mdi-pencil ")])),_:2},1032,["onClick"]),e(X,{size:"small",onClick:al=>i(J)},{default:l(()=>G[6]||(G[6]=[_(" mdi:mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),rt=(g,m)=>{const o=de(g,m),r=de(g,m,void 0,void 0,"item"),p=b(H(r.value));return Q(r,()=>{p.value=H(r.value)}),{state:o,model:r,close:()=>{o.value=!1},reset:()=>{r.value=H(p.value)},save:()=>{m("save")}}},mt=P({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(g,{emit:m}){const o=g,r=m,{state:p,close:d,reset:n,save:u}=rt(o,r);return(t,a)=>(f(),C(Ge,{modelValue:y(p),"onUpdate:modelValue":a[0]||(a[0]=v=>ye(p)?p.value=v:null),onReset:y(n),onSave:y(u),title:t.title,color:"primary","card-class":t.cardClass,fullscreen:!0,persistent:!0},{toolbarButtons:l(()=>[Fe(t.$slots,"toolbarButtons")]),actions:l(()=>[e(x,{color:"blue-darken-1",variant:"text",onClick:y(d)},{default:l(()=>a[1]||(a[1]=[_(" Cancel ")])),_:1},8,["onClick"]),e(x,{color:"blue-darken-1",variant:"text",onClick:y(n)},{default:l(()=>a[2]||(a[2]=[_(" Reset ")])),_:1},8,["onClick"]),e(ne),e(x,{color:"blue-darken-1",variant:"text",onClick:y(u)},{default:l(()=>a[3]||(a[3]=[_(" Save ")])),_:1},8,["onClick"])]),default:l(()=>[Fe(t.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),vt={class:"pa-0 border-0 ma-0"},pt={class:"pa-0 border-0 ma-0"},ft=P({__name:"EditFormField",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=B(),r=b([]),p=b([]),d=b(""),n=u=>{var t;m.value.Field=(t=p.value.find(a=>a.value===u))==null?void 0:t.field};return o.getConventionFields(g.convention.ConventionUUID).then(u=>{u&&(r.value=u,p.value=u.map(t=>({title:`${t.Label} (${(We.find(a=>a.value===t.Type)||{title:""}).title})`,value:t.FieldUUID,field:t})),n(m.value.FieldUUID))}),(u,t)=>(f(),C(F,null,{default:l(()=>[e(D,{cols:"12",md:"6"},{default:l(()=>[N("fieldset",vt,[t[5]||(t[5]=N("legend",{class:"mb-2"},"Field Settings",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:m.value.FieldUUID,"onUpdate:modelValue":[t[0]||(t[0]=a=>m.value.FieldUUID=a),n],items:p.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(R,{modelValue:m.value.MinLength,"onUpdate:modelValue":t[1]||(t[1]=a=>m.value.MinLength=a),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(R,{modelValue:m.value.MaxLength,"onUpdate:modelValue":t[2]||(t[2]=a=>m.value.MaxLength=a),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"4"},{default:l(()=>[e(j,{modelValue:m.value.Required,"onUpdate:modelValue":t[3]||(t[3]=a=>m.value.Required=a),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),m.value.FieldUUID&&m.value.Field?(f(),C(D,{key:0,cols:"12",md:"6"},{default:l(()=>[N("fieldset",pt,[t[6]||(t[6]=N("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1)),m.value.Field?(f(),C(Xe,{key:0,admin:!0,field:m.value.Field,"persistent-hint":!0,required:m.value.Required,convention:u.convention,modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]=a=>d.value=a)},null,8,["field","required","convention","modelValue"])):M("",!0)])]),_:1})):M("",!0)]),_:1}))}}),Vt={class:"d-none d-sm-block"},ct=P({__name:"EditFormSectionFields",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=()=>{var r;return{ID:0,SectionFieldUUID:$(),SectionID:m.value.ID,SectionUUID:m.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((r=m.value.Fields)==null?void 0:r.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(r,p)=>m.value.Fields!==void 0?(f(),C(ze,{key:0,modelValue:m.value.Fields,"onUpdate:modelValue":p[0]||(p[0]=d=>m.value.Fields=d),closeable:!1,title:"Fields","new-item":o,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Ue({_:2},[h(m.value.Fields,(d,n)=>({name:`field_${n}_title`,fn:l(()=>[d.Field?(f(),S(A,{key:0},[_(O(d.Field.Label)+" ("+O(d.Field.Name)+") ",1),N("template",Vt,[_(" ["+O(d.Field.Type)+"] ",1)])],64)):(f(),S(A,{key:1},[_("New Field")],64))])})),h(m.value.Fields,(d,n)=>({name:`field_${n}`,fn:l(()=>[e(ft,{modelValue:m.value.Fields[n],"onUpdate:modelValue":u=>m.value.Fields[n]=u,convention:r.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):M("",!0)}}),Ut=P({__name:"EditFormSections",props:q({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const m=w(g,"modelValue"),o=()=>{const r={ID:0,SectionUUID:$(),FormID:m.value.ID,FormUUID:m.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:$(),SectionID:0,SectionUUID:"",Edit:!0}};return r.State.SectionID=r.ID,r.State.SectionUUID=r.SectionUUID,r};return(r,p)=>(f(),C(ze,{modelValue:m.value.Sections,"onUpdate:modelValue":p[0]||(p[0]=d=>m.value.Sections=d),"new-item":o,closeable:!1,title:"Sections","slot-name-prefix":"section"},Ue({_:2},[h(m.value.Sections,(d,n)=>({name:`section_${n}`,fn:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:d.Name,"onUpdate:modelValue":u=>d.Name=u,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:d.Heading,"onUpdate:modelValue":u=>d.Heading=u,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(ve,{modelValue:d.Description,"onUpdate:modelValue":u=>d.Description=u,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),d.Fields?(f(),C(ct,{key:0,modelValue:m.value.Sections[n],"onUpdate:modelValue":u=>m.value.Sections[n]=u,convention:r.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):M("",!0)])}))]),1032,["modelValue"]))}}),Dt=P({__name:"FormRendererPopup",props:q({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:q(["update:form"],["update:modelValue"]),setup(g,{emit:m}){const o=g,{admin:r=!1,convention:p,title:d="",cardClass:n=""}=o,u=m,t=w(g,"modelValue"),a=de(o,u,void 0,void 0,"form"),v=b(H(a.value));Q(a,()=>{v.value=H(a.value)});const V=()=>{t.value=!1};return(U,s)=>(f(),C(Ge,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=i=>t.value=i),title:y(d),color:"primary","card-class":y(n),fullscreen:!0,scrollable:!0},{toolbarButtons:l(()=>[Fe(U.$slots,"toolbarButtons")]),actions:l(()=>[e(x,{color:"blue-darken-1",variant:"text",onClick:V},{default:l(()=>s[2]||(s[2]=[_(" Close ")])),_:1})]),default:l(()=>[e(pl,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=i=>v.value=i),admin:y(r),convention:y(p),preview:U.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),Tt=P({__name:"EditFormDialog",props:q({convention:{},form:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:q(["update:form"],["update:modelValue"]),setup(g,{emit:m}){const o=g,{convention:r}=o,p=w(g,"modelValue"),d=m,n=B(),u=de(o,d,void 0,void 0,"form"),t=b(!1),a=b(H(u.value));Q(u,()=>{a.value=H(u.value)});const v=()=>{n.saveForm(a.value).then(U=>{U&&(u.value=U,p.value=!1)})},V=()=>{t.value=!0};return(U,s)=>(f(),C(mt,{modelValue:p.value,"onUpdate:modelValue":s[14]||(s[14]=i=>p.value=i),item:a.value,"onUpdate:item":s[15]||(s[15]=i=>a.value=i),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(cl,null,{default:l(()=>[e(x,{"prepend-icon":"mdi:mdi-developer-board",onClick:V},{default:l(()=>s[16]||(s[16]=[N("template",{class:"d-none d-sm-inline"},[_("Preview")],-1)])),_:1})]),_:1})]),default:l(()=>[e(pe,null,{default:l(()=>[e(fe,{class:"mt-0"},{default:l(()=>[e(Ve,null,{default:l(()=>s[17]||(s[17]=[_("General Settings")])),_:1}),e(ce,null,{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(z,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:a.value.Name,"onUpdate:modelValue":s[0]||(s[0]=i=>a.value.Name=i),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:a.value.Heading,"onUpdate:modelValue":s[1]||(s[1]=i=>a.value.Heading=i),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ve,{modelValue:a.value.Description,"onUpdate:modelValue":s[2]||(s[2]=i=>a.value.Description=i),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(W,{modelValue:a.value.Type,"onUpdate:modelValue":s[3]||(s[3]=i=>a.value.Type=i),label:"Type",variant:"outlined",items:y(fl),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:a.value.NotificationEmail,"onUpdate:modelValue":s[4]||(s[4]=i=>a.value.NotificationEmail=i),label:"Notification Email",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",class:"d-none"},{default:l(()=>[e(R,{modelValue:a.value.State.Stage,"onUpdate:modelValue":s[5]||(s[5]=i=>a.value.State.Stage=i),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(j,{modelValue:a.value.State.New,"onUpdate:modelValue":s[6]||(s[6]=i=>a.value.State.New=i),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(j,{modelValue:a.value.State.Edit,"onUpdate:modelValue":s[7]||(s[7]=i=>a.value.State.Edit=i),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(j,{modelValue:a.value.State.Independent,"onUpdate:modelValue":s[8]||(s[8]=i=>a.value.State.Independent=i),label:"Independent of Registration Form"},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Z,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":s[9]||(s[9]=i=>a.value.RequiredTags=i),convention:y(r),organisation:y(r).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Le,{label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":s[10]||(s[10]=i=>a.value.RequiredGroupMemberships=i),convention:y(r),organisation:y(r).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a.value?(f(),C(Ut,{key:0,modelValue:a.value,"onUpdate:modelValue":s[11]||(s[11]=i=>a.value=i),convention:y(r),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):M("",!0),t.value?(f(),C(Dt,{key:1,modelValue:t.value,"onUpdate:modelValue":s[12]||(s[12]=i=>t.value=i),form:a.value,"onUpdate:form":s[13]||(s[13]=i=>a.value=i),admin:!0,convention:y(r),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):M("",!0)]),_:1},8,["modelValue","item"]))}}),It=(g,m)=>{const o=b(!1),r=b(!1),p=b(g),d=b(-1),n=b(m),u=b(m),t=ae(()=>d.value===-1?"New Form":"Edit Form"),a=()=>{p.value=g},v=I=>{d.value=p.value.indexOf(I),n.value=Object.assign({},I),o.value=!0},V=I=>{d.value=p.value.indexOf(I),n.value=Object.assign({},I),r.value=!0},U=()=>{r.value=!1,be(()=>{n.value=Object.assign({},u.value),d.value=-1}).then()},s=()=>{p.value.splice(d.value,1),U()},i=()=>{o.value=!1,be(()=>{n.value=Object.assign({},u.value),d.value=-1}).then()},c=()=>{d.value>-1?Object.assign(p.value[d.value],n.value):p.value.push(n.value),i()};return Q(o,I=>{I||i()}),Q(r,I=>{I||U()}),{collection:p,defaultItem:u,dialog:o,dialogDelete:r,editedItem:n,formTitle:t,reset:a,editItem:v,deleteItem:V,deleteItemConfirm:s,close:i,save:c}},gt=P({__name:"FormEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:q(["refresh"],["update:modelValue"]),setup(g){const m=w(g,"modelValue"),o=B(),r=b([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),p=b([]),d=b([]);o.getConventionFields(m.value.ConventionUUID).then(k=>{p.value=k}),o.getConventionForms(m.value.ConventionUUID).then(k=>{d.value=k});const n={ID:0,FormUUID:$(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,ParentID:0,ParentUUID:ke,Name:"",Heading:"",Description:"",Type:Vl.FORM_TYPE_ADDITIONAL,Sections:[],State:{ID:0,FormStateUUID:$(),FormID:0,FormUUID:ke,New:!1,Edit:!1,Stage:0,Independent:!1},RequiredGroupMemberships:[],RequiredTags:[],NotificationEmail:""};n.State.FormUUID=n.FormUUID;const{collection:u,defaultItem:t,dialog:a,dialogDelete:v,editedItem:V,editItem:U,deleteItem:s,deleteItemConfirm:i,save:c}=It(d,n);u.value.forEach(k=>{k.Sections.forEach(T=>{var E;(E=T.Fields)==null||E.forEach(G=>{G.Field=p.value.find(J=>J.ID===G.FieldID)})})});const I=k=>{o.deleteForm(k.FormUUID).then(T=>{T&&s(k)})};return(k,T)=>(f(),C(Qe,{headers:r.value,items:y(u),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(re,{color:"primary"},{default:l(()=>[e(me,null,{default:l(()=>T[4]||(T[4]=[_("Form Editor")])),_:1}),e(Ze,{class:"mx-4",inset:!0,vertical:!0}),e(ne),e(x,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:T[0]||(T[0]=E=>{V.value=Object.assign({},y(t)),a.value=!0})},{default:l(()=>T[5]||(T[5]=[_(" New Item ")])),_:1}),e(Ke,{modelValue:y(v),"onUpdate:modelValue":T[1]||(T[1]=E=>ye(v)?v.value=E:null),onDelete:y(i)},null,8,["modelValue","onDelete"])]),_:1}),y(a)?(f(),C(Tt,{key:0,title:y(V).Name?`Edit Form - ${y(V).Name}`:"Create New Form",modelValue:y(a),"onUpdate:modelValue":T[2]||(T[2]=E=>ye(a)?a.value=E:null),form:y(V),"onUpdate:form":[T[3]||(T[3]=E=>ye(V)?V.value=E:null),y(c)],convention:m.value},null,8,["title","modelValue","form","onUpdate:form","convention"])):M("",!0)]),"item.actions":l(({item:E})=>[e(X,{size:"small",class:"me-2",onClick:G=>y(U)(E)},{default:l(()=>T[6]||(T[6]=[_(" mdi:mdi-pencil ")])),_:2},1032,["onClick"]),e(X,{size:"small",onClick:G=>I(E)},{default:l(()=>T[7]||(T[7]=[_(" mdi:mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),yt=P({__name:"LinkedFields",props:{convention:{}},emits:["update:convention"],async setup(g,{emit:m}){let o,r;const p=g,{getLinkedFields:d,saveLinkedFields:n,linkedFieldsKey:u}=dl(),a=de(p,m,void 0,void 0,"convention"),v=b(([o,r]=Ee(()=>d(a.value.ConventionUUID)),o=await o,r(),o)),V=b(!1),U=async()=>{try{V.value=!0,v.value&&await n(a.value.ConventionUUID,v.value)}catch(c){console.error(c)}V.value=!1},s=b([]),i=([o,r]=Ee(()=>Dl(a.value.ConventionUUID)),o=await o,r(),o);return i&&(i.forEach(c=>c.Sections.forEach(I=>I.Fields&&s.value.push(...I.Fields.map(k=>{var E;return{title:`${c.Name} - ${I.Name} - ${(E=k.Field)==null?void 0:E.Name}`,value:k.SectionFieldUUID,object:k}})))),s.value.sort(ul("title"))),(c,I)=>(f(),C(Be,{method:"post",action:`/api/convention/${y(a).ConventionUUID}/config/${y(u)}`,onSubmit:oe(U,["prevent"]),class:"pa-sm-4"},{default:l(()=>[I[6]||(I[6]=N("h2",null,"Linked Fields",-1)),I[7]||(I[7]=N("p",null," This defines which fields are used by the registration search system. ",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:v.value.badge_name,"onUpdate:modelValue":I[0]||(I[0]=k=>v.value.badge_name=k),label:"Main Badge Name",items:s.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:v.value.forename,"onUpdate:modelValue":I[1]||(I[1]=k=>v.value.forename=k),label:"Forename",items:s.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:v.value.surname,"onUpdate:modelValue":I[2]||(I[2]=k=>v.value.surname=k),label:"Surname",items:s.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:v.value.dob,"onUpdate:modelValue":I[3]||(I[3]=k=>v.value.dob=k),label:"Date of Birth",items:s.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:v.value.address,"onUpdate:modelValue":I[4]||(I[4]=k=>v.value.address=k),label:"Address",items:s.value,"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(x,{type:"submit",color:"success"},Ue({default:l(()=>[I[5]||(I[5]=_(" Save "))]),_:2},[V.value?{name:"prepend",fn:l(()=>[e(qe,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},8,["action"]))}}),Ct={class:"mt-4"},bt=P({__name:"Stripe",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],async setup(g){let m,o;const{getStripeConfig:r,saveStripeConfig:p,stripeConfigKey:d}=Tl(),n=B(),u=w(g,"modelValue"),t=b(([m,o]=Ee(()=>r(u.value.ConventionUUID)),m=await m,o(),m)),a=b(!1),v=async()=>{try{a.value=!0,t.value&&await p(u.value.ConventionUUID,t.value)}catch(U){console.error(U)}a.value=!1},V=U=>{try{navigator.clipboard.writeText(U).catch(()=>{})}catch{}};return(U,s)=>(f(),C(Be,{method:"post",action:`/api/convention/${u.value.ConventionUUID}/config/${y(d)}`,onSubmit:oe(v,["prevent"]),class:"pa-sm-4"},{default:l(()=>[s[10]||(s[10]=N("h2",null,"Stripe Configuration",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(R,{label:"Private Key","hide-details":"",modelValue:t.value.private_key,"onUpdate:modelValue":s[0]||(s[0]=i=>t.value.private_key=i)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:"Public Key","hide-details":"",modelValue:t.value.public_key,"onUpdate:modelValue":s[1]||(s[1]=i=>t.value.public_key=i)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:"Webhook ID","hide-details":"",modelValue:t.value.webhook_id,"onUpdate:modelValue":s[2]||(s[2]=i=>t.value.webhook_id=i)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:"Webhook Key","hide-details":"",modelValue:t.value.webhook_secret,"onUpdate:modelValue":s[3]||(s[3]=i=>t.value.webhook_secret=i)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{label:"Support Email Address","hide-details":"",modelValue:t.value.support_email,"onUpdate:modelValue":s[4]||(s[4]=i=>t.value.support_email=i)},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(ve,{label:"Payment Information","hide-details":"",modelValue:t.value.payment_information_html,"onUpdate:modelValue":s[5]||(s[5]=i=>t.value.payment_information_html=i)},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[s[7]||(s[7]=N("p",{class:"font-weight-bold"}," WebHook URI ",-1)),s[8]||(s[8]=N("p",null,[N("small",null,"Setup a Stripe WebHook using this URI and add all payment_intent events.")],-1)),N("p",Ct,[e(Il,{text:"Click to Copy"},{activator:l(({props:i})=>[N("span",Ce({class:"cursor-pointer",onClick:s[6]||(s[6]=c=>V(`${y(n).getEndPoint()}/stripe/hook/${u.value.ConventionUUID}`))},i),[_(O(y(n).getEndPoint())+"/stripe/hook/"+O(u.value.ConventionUUID)+" ",1),e(X,{icon:"mdi:mdi-clipboard-outline"})],16)]),_:1})])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(x,{type:"submit",color:"success"},Ue({default:l(()=>[s[9]||(s[9]=_(" Save "))]),_:2},[a.value?{name:"prepend",fn:l(()=>[e(qe,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},8,["action"]))}}),kt=P({__name:"PaymentProcessor",props:{convention:{required:!0},conventionModifiers:{}},emits:["update:convention"],setup(g){const m=w(g,"convention"),o=b(""),r=b(),p=b([{id:$(),title:"Stripe",component:ue(bt),model:m}]);return(d,n)=>(f(),S(A,null,[o.value?(f(),C(gl,{key:0,type:"error"},{default:l(()=>[e(yl,null,{default:l(()=>n[2]||(n[2]=[_("Error Encountered")])),_:1}),_(" "+O(o.value),1)]),_:1})):M("",!0),e(Me,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=u=>r.value=u),"bg-color":"secondary","show-arrows":""},{default:l(()=>[(f(!0),S(A,null,h(p.value,(u,t)=>(f(),C(xe,{key:t,text:u.title,value:u.id},null,8,["text","value"]))),128))]),_:1},8,["modelValue"]),e(Oe,{modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=u=>r.value=u)},{default:l(()=>[(f(!0),S(A,null,h(p.value,(u,t)=>(f(),C(Pe,{key:t,value:u.id},{default:l(()=>[e(se,{class:"pa-2"},{default:l(()=>[(f(),C(He(u.component),{modelValue:u.model,"onUpdate:modelValue":a=>u.model=a},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64))}}),Ye="reference_settings",Et=()=>({start_index:"",reserved_values:[],method:ll.NONE,min_length:0,max_length:0,add_checksum:!1,checksum_algorithm:tl.NONE}),_t=async g=>{const{getConventionConfig:m}=el();return await m(g,Ye)||Et()},St=async(g,m)=>{const{saveConventionConfig:o}=el();return await o(g,Ye,m)};function Nt(){return{getReferenceSettings:_t,saveReferenceSettings:St,ReferenceSettingsKey:Ye}}const At=P({__name:"ReferenceSettings",props:{convention:{}},emits:["update:convention"],async setup(g,{emit:m}){let o,r;const p=g,{getReferenceSettings:d,saveReferenceSettings:n,ReferenceSettingsKey:u}=Nt(),a=de(p,m,void 0,void 0,"convention"),v=b(([o,r]=Ee(()=>d(a.value.ConventionUUID)),o=await o,r(),o)),V=b(!1),U=b(""),s=()=>{U.value.trim()&&(v.value.reserved_values.push(U.value.trim()),U.value="")},i=I=>{v.value.reserved_values.splice(I,1)},c=async()=>{try{V.value=!0,v.value&&await n(a.value.ConventionUUID,v.value)}catch(I){console.error(I)}V.value=!1};return(I,k)=>(f(),C(Be,{method:"post",action:`/api/convention/${y(a).ConventionUUID}/config/${y(u)}`,onSubmit:oe(c,["prevent"]),class:"pa-2 pa-sm-4"},{default:l(()=>[k[10]||(k[10]=N("h2",null,"Reference Settings",-1)),k[11]||(k[11]=N("p",null," Controls how references are assigned to registrations. References are a.k.a. Badge Numbers. ",-1)),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:v.value.method,"onUpdate:modelValue":k[0]||(k[0]=T=>v.value.method=T),label:"Assignment Method",items:y(Cl),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{modelValue:v.value.start_index,"onUpdate:modelValue":k[1]||(k[1]=T=>v.value.start_index=T),label:"Initial Value","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{modelValue:v.value.min_length,"onUpdate:modelValue":k[2]||(k[2]=T=>v.value.min_length=T),modelModifiers:{number:!0},label:"Minimum Length","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(R,{modelValue:v.value.max_length,"onUpdate:modelValue":k[3]||(k[3]=T=>v.value.max_length=T),modelModifiers:{number:!0},label:"Maximum Length",hint:"Zero is infinite"},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",class:"py-0"},{default:l(()=>k[7]||(k[7]=[_(" Reserved Values ")])),_:1}),v.value.reserved_values.length>0?(f(),C(D,{key:0,class:"py-0",cols:"12"},{default:l(()=>[(f(!0),S(A,null,h(v.value.reserved_values,(T,E)=>(f(),C(he,{key:E,onClick:G=>i(E)},{default:l(()=>[_(O(T),1)]),_:2},1032,["onClick"]))),128))]),_:1})):M("",!0),e(D,{class:"py-0",cols:"8",sm:"10"},{default:l(()=>[e(R,{modelValue:U.value,"onUpdate:modelValue":k[4]||(k[4]=T=>U.value=T),label:"Add item",onKeyup:ol(s,["enter"]),class:"mt-4",clearable:""},null,8,["modelValue"])]),_:1}),e(D,{cols:"4",sm:"2"},{default:l(()=>[e(x,{class:"mt-4",color:"primary",onClick:s,disabled:!U.value},{default:l(()=>k[8]||(k[8]=[_(" Add ")])),_:1},8,["disabled"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(j,{modelValue:v.value.add_checksum,"onUpdate:modelValue":k[5]||(k[5]=T=>v.value.add_checksum=T),label:"Apply Checksum","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(W,{modelValue:v.value.checksum_algorithm,"onUpdate:modelValue":k[6]||(k[6]=T=>v.value.checksum_algorithm=T),label:"Checksum Algorithm",items:y(bl),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(x,{type:"submit",color:"success"},Ue({default:l(()=>[k[9]||(k[9]=_(" Save "))]),_:2},[V.value?{name:"prepend",fn:l(()=>[e(qe,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},8,["action"]))}}),Aa=P({__name:"ConventionEditorView",emits:["delete","pageTitle","refresh"],setup(g,{emit:m}){const o=m,r=nl(),p=B(),n=b({ID:0,ConventionUUID:ke,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),u=b(!1),t=b(`
Are you sure you wish to delete this convention? All data relating to it will be
removed including all registrations and payment information. This action can
not be undone. To confirm type "I UNDERSTAND" in the box below.
`),a=b(),v=b(),V=b([{id:"general",title:"General",component:void 0,model:null},{id:"configuration",title:"Main Configuration",component:void 0,model:null},{id:"linked",title:"Linked Fields",component:void 0,model:null},{id:"payments",title:"Payment Processor",component:void 0,model:null},{id:"references",title:"Reference Numbers",component:void 0,model:null}]),U=b([{id:$(),title:"Accommodation",component:ue(Xl),model:n},{id:$(),title:"Additional Purchases",component:ue(Sl),model:n},{id:$(),title:"Fields",component:ue(st),model:n},{id:$(),title:"Forms",component:ue(gt),model:n},{id:$(),title:"Interests",component:ue(Fl),model:n},{id:$(),title:"Tickets",component:ue(Gl),model:n},{id:$(),title:"Venues",component:ue(zl),model:n}]),s=i=>{p.deleteConvention(n.value.ConventionUUID).then(c=>{c?i&&(i("Convention Deleted"),o("delete")):i&&i("Failed to Delete Convention"),setTimeout(()=>{u.value=!1},2e3)}).catch(()=>{i&&(i("Failed to Delete Organisation"),u.value=!1)})};return o("pageTitle","Convention Editor"),p.getConvention(r.params.convention.toString()).then(i=>{i?(n.value=i,o("pageTitle",`Convention Editor - ${n.value.Name}`)):o("pageTitle","Convention Editor - New Convention")}),(i,c)=>(f(),C(le,null,{default:l(()=>[e(Me,{modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=I=>a.value=I),"bg-color":"primary","show-arrows":"","selected-class":"bg-secondary","hide-slider":""},{default:l(()=>[(f(!0),S(A,null,h(V.value,(I,k)=>(f(),C(xe,{key:k,text:I.title,value:I.id},null,8,["text","value"]))),128))]),_:1},8,["modelValue"]),e(Oe,{modelValue:a.value,"onUpdate:modelValue":c[9]||(c[9]=I=>a.value=I)},{default:l(()=>[(f(!0),S(A,null,h(V.value,(I,k)=>(f(),C(Pe,{key:k,value:I.id},{default:l(()=>[a.value===I.id?(f(),S(A,{key:0},[I.id==="general"?(f(),S(A,{key:0},[e(Ul,{embed:!0,convention:n.value,"onUpdate:convention":c[1]||(c[1]=T=>n.value=T),onDelete:c[2]||(c[2]=T=>u.value=!0),title:`${n.value.Name} General Settings`},null,8,["convention","title"]),e(Ke,{modelValue:u.value,"onUpdate:modelValue":c[3]||(c[3]=T=>u.value=T),"confirmation-text":"I UNDERSTAND",message:t.value,title:"Delete Convention",subtitle:"A quick way to make enemies",onDelete:s},null,8,["modelValue","message"])],64)):I.id==="configuration"?(f(),S(A,{key:1},[n.value&&n.value.ConventionUUID!==y(ke)?(f(),C(Me,{key:0,modelValue:v.value,"onUpdate:modelValue":c[4]||(c[4]=T=>v.value=T),"bg-color":"secondary","show-arrows":""},{default:l(()=>[(f(!0),S(A,null,h(U.value,(T,E)=>(f(),C(xe,{key:E,text:T.title,value:T.id},null,8,["text","value"]))),128))]),_:1},8,["modelValue"])):M("",!0),e(Oe,{modelValue:v.value,"onUpdate:modelValue":c[5]||(c[5]=T=>v.value=T)},{default:l(()=>[(f(!0),S(A,null,h(U.value,(T,E)=>(f(),C(Pe,{key:E,value:T.id},{default:l(()=>[e(se,{class:"pa-2"},{default:l(()=>[(f(),C(He(T.component),{modelValue:T.model,"onUpdate:modelValue":G=>T.model=G},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue"])],64)):I.id==="linked"?(f(),C(Ae,{key:2},{default:l(()=>[e(yt,{convention:n.value,"onUpdate:convention":c[6]||(c[6]=T=>n.value=T)},null,8,["convention"])]),_:1})):I.id==="payments"?(f(),C(Ae,{key:3},{default:l(()=>[e(kt,{convention:n.value,"onUpdate:convention":c[7]||(c[7]=T=>n.value=T)},null,8,["convention"])]),_:1})):I.id==="references"?(f(),C(Ae,{key:4},{default:l(()=>[e(At,{convention:n.value,"onUpdate:convention":c[8]||(c[8]=T=>n.value=T)},null,8,["convention"])]),_:1})):M("",!0)],64)):M("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}))}});export{Aa as default};
