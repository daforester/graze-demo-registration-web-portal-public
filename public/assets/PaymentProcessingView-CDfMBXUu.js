import{i as T,r as d,q as b,v as l,R as D,Q as I,O as R,n as a,f as y,D as o,x as t,H as r,G as s,y as f,A as c}from"./index-BYkgOSXE.js";import{l as B}from"./stripe.esm-v5H38J3X.js";import{u as _}from"./useStripeConfig-BogXT0Ve.js";import{V as N}from"./VContainer-gFImxAXb.js";import{V as w,a as h}from"./VRow-DBsEmuca.js";import{o as q,V as A}from"./VGrid-CBSbidIE.js";import{V as E}from"./VAlert-BLIfLqA1.js";import"./useConventionConfig-C-G2kKA8.js";import"./createSimpleFunctional-CHPZap2d.js";const G={class:"my-4"},H=["href"],z={key:0},F={class:"my-4"},O=["href"],$={key:0},ee=T({__name:"PaymentProcessingView",emits:["pageTitle"],setup(K,{emit:V}){const{getStripeConfig:S}=_(),v=D(),x=I(),C=R();V("pageTitle","Payment Processing");const g=d(),i=d(""),p=d(""),k=()=>{x.push({name:"Home"})},u=d("");S(v.params.convention.toString()).then(n=>{n&&n.support_email&&(u.value=n.support_email)}),C.stripePublicKey(v.params.convention.toString()).then(async n=>{n&&(g.value=await B(n),await P(g.value))});async function P(n){if(!n)return;const e=new URLSearchParams(window.location.search).get("payment_intent_client_secret");if(!e)return;const{paymentIntent:m}=await n.retrievePaymentIntent(e);p.value=(m==null?void 0:m.id)||"",i.value=(m==null?void 0:m.status)||"",i.value==="processing"&&setTimeout(()=>{P(n)},2e3)}return(n,e)=>(a(),b(N,null,{default:l(()=>[y(E,{closable:!0,"onClick:close":k},{title:l(()=>[i.value==""?(a(),o(r,{key:0},[t(" Retrieving Payment Status ")],64)):i.value=="succeeded"?(a(),o(r,{key:1},[t(" Payment Succeeded ")],64)):i.value=="processing"?(a(),o(r,{key:2},[t(" Payment Processing ")],64)):i.value=="requires_payment_method"?(a(),o(r,{key:3},[t(" Payment Failed ")],64)):(a(),o(r,{key:4},[t(" Payment Error ")],64))]),text:l(()=>[i.value==""?(a(),b(w,{key:0},{default:l(()=>[y(h,{class:"text-center"},{default:l(()=>[y(q,{color:"primary",indeterminate:"",size:175,width:12,class:"font-weight-bold my-4"},{default:l(()=>e[0]||(e[0]=[t(" Processing"),s("br",null,null,-1),t("Payment ")])),_:1})]),_:1})]),_:1})):i.value=="succeeded"?(a(),o(r,{key:1},[e[1]||(e[1]=s("p",{class:"my-4"},"Thank you for submitting your payment, you will receive an email shortly confirming receipt.",-1)),e[2]||(e[2]=s("p",{class:"my-4"},"The main dashboard will shortly update showing your payment.",-1))],64)):i.value=="processing"?(a(),o(r,{key:2},[e[3]||(e[3]=s("p",{class:"my-4"},"Thank you for submitting your payment, the payment is currently being processed.",-1)),e[4]||(e[4]=s("p",{class:"my-4"}," If the payment processing is successful the main dashboard will shortly update showing your payment. You will also receive an email confirming receipt. ",-1))],64)):i.value=="requires_payment_method"?(a(),o(r,{key:3},[e[9]||(e[9]=s("p",{class:"my-4"},"Thank you for submitting your payment, however the payment has failed.",-1)),s("p",G,[e[7]||(e[7]=t(" Please try again and check your payment details, if the payment has been blocked you may need to contact your bank. ")),u.value?(a(),o(r,{key:0},[e[5]||(e[5]=t(" If you continue to experience problems please email ")),s("a",{href:`mailto:${u.value}`},f(u.value),9,H),e[6]||(e[6]=t(" for additional support and provide the ID below. "))],64)):c("",!0)]),p.value?(a(),o("p",z,[e[8]||(e[8]=s("strong",null,"Payment ID:",-1)),t(" RPM-"+f(p.value),1)])):c("",!0)],64)):(a(),o(r,{key:4},[e[14]||(e[14]=s("p",{class:"my-4"},"Thank you for submitting your payment, however the payment has failed.",-1)),s("p",F,[e[12]||(e[12]=t(" Please try again and check your payment details, if the payment has been blocked you may need to contact your bank. ")),u.value?(a(),o(r,{key:0},[e[10]||(e[10]=t(" If you continue to experience problems please email ")),s("a",{href:`mailto:${u.value}`},f(u.value),9,O),e[11]||(e[11]=t(" for additional support and provide the ID below. "))],64)):c("",!0)]),p.value?(a(),o("p",$,[e[13]||(e[13]=s("strong",null,"Payment ID:",-1)),t(" GE-"+f(p.value),1)])):c("",!0)],64))]),default:l(()=>[y(w,null,{default:l(()=>[y(h,{class:"text-center"},{default:l(()=>[y(A,{onClick:k,variant:"flat",color:"success"},{default:l(()=>e[15]||(e[15]=[t("Okay")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{ee as default};
