import{i as h,L as D,M as I,r as C,k as V,w as A,$ as L,n as U,q as _,v as o,f as e,F as u,A as N,O as k}from"./index-BQtVy5Zl.js";import{_ as T}from"./ModelDialog.vue_vue_type_script_setup_true_lang-BSuWlgMZ.js";import{s}from"./index-fwfMqYug.js";import{u as B}from"./useStoreAPI-CQH4X90B.js";import{_ as E}from"./SelectGroups.vue_vue_type_script_setup_true_lang-DkdkZl_q.js";import{V as P}from"./VContainer-BkTyUv1W.js";import{V as m,a as i}from"./VRow-Bq6xw4wO.js";import{V as j}from"./forwardRefs-CZ3566jw.js";import{V as g}from"./VTextField-9oKHvVh6.js";import{V as z}from"./VTextarea-CxZupCPw.js";import{V as O}from"./VCheckbox-BDkGQO0g.js";import{V as H}from"./VForm-9t3K7MfT.js";import{V as J}from"./VFileInput-BXl5Kg-y.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=h({__name:"EditConventionDialog",props:D({embed:{type:Boolean},title:{}},{modelValue:{type:Boolean,required:!1},modelModifiers:{},convention:{required:!0},conventionModifiers:{}}),emits:D(["update:convention","delete","save"],["update:modelValue","update:convention"]),setup(d,{emit:F}){const w=d,R=k(),v=B(),{title:y=""}=w,c=F,b=I(d,"modelValue"),r=I(d,"convention"),a=C(V(r.value));A(r,()=>{a.value=V(r.value),p.value=`${v.GetConventionLogoURL(a.value.ConventionUUID)}?${new Date().getTime()}`});const p=C(`${v.GetConventionLogoURL(a.value.ConventionUUID)}?${new Date().getTime()}`),f=L("imageFileInput"),x=L("conventionImageForm"),M=()=>{f.value&&f.value.files&&(p.value=URL.createObjectURL(f.value.files[0]))},G=()=>{c("delete")},S=()=>{a.value=V(r.value)},$=async()=>{var l;const n=new FormData((l=x.value)==null?void 0:l.$el);if(n.get("Image")&&n.get("Image").size>0)return n.set("ConventionUUID",a.value.ConventionUUID),await v.SaveConventionLogo(n)},q=n=>{$(),R.saveConvention(a.value).then(l=>{l?n&&n("Convention Data Saved").then(()=>{r.value=l,c("save",l)}):n&&n("Failed to save")}).catch(()=>{n("Failed to save")})};return(n,l)=>(U(),_(T,{modelValue:b.value,"onUpdate:modelValue":l[6]||(l[6]=t=>b.value=t),onDelete:G,onReset:S,onSave:q,title:u(y),color:"primary","show-close-action":!0,"show-delete-action":!0,"show-reset-action":!0,"show-save-action":!0,fullscreen:!0,persistent:!0,embed:n.embed},{default:o(()=>[e(P,{class:"pa-0",fluid:!0},{default:o(()=>[e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(j,{class:"imgLogo mx-auto",src:p.value||""},null,8,["src"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(g,{label:u(s).formLabelName,name:"Name",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.Name=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(z,{label:u(s).formLabelDescription,name:"Description",variant:"outlined",multiline:"true",modelValue:a.value.Description,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.Description=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(g,{label:u(s).formLabelDetailLink,name:"DetailLink",variant:"outlined",multiline:"true",modelValue:a.value.DetailLink,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.DetailLink=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(g,{label:u(s).formLabelSlug,name:"Slug",variant:"outlined",multiline:"true",modelValue:a.value.Slug,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.Slug=t)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:o(()=>[e(O,{label:u(s).formConventionVisible,name:"Visible",modelValue:a.value.Visible,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.Visible=t)},null,8,["label","modelValue"])]),_:1}),e(i,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:o(()=>[a.value.RequiredGroupMemberships?(U(),_(E,{key:0,label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.RequiredGroupMemberships=t),convention:a.value,chips:"",clearable:"",hint:"Groups that a user must be in to see this convention. (Any one, empty = public)"},null,8,["modelValue","convention"])):N("",!0)]),_:1})]),_:1}),e(m,null,{default:o(()=>[e(i,null,{default:o(()=>[e(H,{ref:"conventionImageForm",enctype:"multipart/form-data"},{default:o(()=>[e(J,{label:u(s).formLabelLogo,name:"Image",variant:"outlined",ref:"imageFileInput",accept:"image/avif, image/bmp, image/gif, image/jpeg, image/png, image/webp","hide-details":"",onChange:M},null,8,["label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","embed"]))}}),re=K(Q,[["__scopeId","data-v-2c81d5ab"]]);export{re as E};
